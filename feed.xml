<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="https://wjohn1483.github.io/#%20the%20base%20hostname%20&%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://wjohn1483.github.io/#%20the%20base%20hostname%20&%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/" rel="alternate" type="text/html" /><updated>2023-02-05T12:04:53+00:00</updated><id>https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/feed.xml</id><title type="html">wjohn1483.github.io</title><subtitle></subtitle><author><name>Your Name</name></author><entry><title type="html">KGAT: Knowledge Graph Attention Network for Recommendation</title><link href="https://wjohn1483.github.io/#%20the%20base%20hostname%20&%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2023/02/02/kgat/" rel="alternate" type="text/html" title="KGAT: Knowledge Graph Attention Network for Recommendation" /><published>2023-02-02T00:00:00+00:00</published><updated>2023-02-02T00:00:00+00:00</updated><id>https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2023/02/02/kgat</id><content type="html" xml:base="https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2023/02/02/kgat/"><![CDATA[<p>é€™ç¯‡æ–‡ç« ç´€éŒ„ä¸€ä¸‹çœ‹äº†<a href="https://arxiv.org/pdf/1905.07854.pdf">KGAT: Knowledge Graph Attention Network for Recommendation</a>çš„ç­†è¨˜ã€‚</p>

<!--more-->

<p>åœ¨éå»çš„æ¨è–¦ç³»çµ±ç•¶ä¸­ï¼Œè »å¸¸ä½¿ç”¨collaborative filteringï¼ˆCFï¼‰ä¾†ç”¢ç”Ÿæ¨è–¦ï¼Œè—‰ç”±è§€å¯Ÿä½¿ç”¨è€…å’Œå•†å“çš„äº’å‹•è¡Œç‚ºï¼Œä¾†æ‰¾å‡ºç›®æ¨™ä½¿ç”¨è€…è·Ÿå“ªäº›ç¾æœ‰çš„ä½¿ç”¨è€…ç›¸ä¼¼ï¼Œç”¨ç¾æœ‰ä½¿ç”¨è€…æœ‰äº’å‹•éçš„å•†å“ä¾†æ¨è–¦çµ¦ç›®æ¨™ä½¿ç”¨è€…ã€‚</p>

<p>ç„¶è€Œï¼Œåœ¨collaborative filteringç•¶ä¸­ï¼Œæ¯”è¼ƒå°‘è‘—å¢¨æ–¼ä½¿ç”¨è€…æœ¬èº«çš„ç‰¹æ€§ä»¥åŠå•†å“ä¹‹é–“çš„é—œè¯ï¼Œä¸»è¦åªä½¿ç”¨ä½¿ç”¨è€…å°å•†å“çš„è¡Œç‚ºä¾†ç•¶ä½œè¼¸å…¥ï¼Œè€Œé€™ç¯‡paperå˜—è©¦å¼•å…¥äº†knowledge graphé€²ä¾†ï¼Œè—‰æ­¤è£œè¶³collaborative filteringä¸è¶³çš„éƒ¨åˆ†ã€‚</p>

<h2 id="task-formulation">Task Formulation</h2>

<p>é€™é‚Šå…ˆä»‹ç´¹ä¸€ä¸‹åœ¨é€™ç¯‡paperè£¡é¢æ‰€ä½¿ç”¨åˆ°çš„graphï¼Œä¸»è¦æ˜¯ç”±å…©å€‹bipartiteçµ„æˆã€‚</p>

<p><img src="./collaborative_knowledge_graph.png" alt="Collaborative knowledge graph" /></p>

<p>ä¸ŠåŠéƒ¨çš„Usersã€Itemsæ˜¯collaborative filteringçš„éƒ¨åˆ†ï¼Œç”±userå’Œitemçµ„æˆï¼Œå…¶ä¸­å…©è€…çš„é—œä¿‚$r_1$æ˜¯æŒ‡userçœ‹éitemçš„æ„æ€ï¼Œèˆ‰ä¾‹ä¾†èªªuser $u_1$çœ‹éitem $i_1$ï¼Œå°±æœƒåœ¨ä¸Šåœ–æœ‰å€‹$u_1$çš„nodeï¼Œä¸¦æœ‰ä¸€å€‹ç®­é ­$r_1$æŒ‡å‘item $i_1$çš„nodeã€‚</p>

<p>ä¸‹åŠéƒ¨çš„Itemsã€Entitiesæ˜¯knowledge graphçš„éƒ¨åˆ†ï¼Œæ¯ä¸€å€‹$e_n$è¡¨ç¤ºçš„æ˜¯itemçš„ç‰¹æ€§ï¼Œè€Œitemå’Œentityä¹‹é–“å¯èƒ½æœ‰å¾ˆå¤šçš„é—œä¿‚åƒæ˜¯é›»å½±ç¨®é¡ã€å°æ¼”ã€æ¼”å“¡ç­‰ã€‚</p>

<p>ä½œè€…å°‡é€™å€‹ç”±å…©å€‹bipartiteçµ„æˆçš„graphç¨±ä¹‹ç‚º<strong>Collaborative Knowledge Graph</strong>ï¼Œå¯ä»¥ç°¡å–®æƒ³æˆæ˜¯æˆ‘å€‘æŠŠ$u_1$çœ‹é$i_1$åšæˆ$(u_1, r_1, i_1)$é€™æ¨£çš„tripletä¹Ÿæ”¾é€²knowledge graphè£¡é¢ã€‚</p>

<h2 id="method">Method</h2>

<p>ä¸Šé¢çš„éƒ¨åˆ†ä¸»è¦æ˜¯æ¨¡å‹è¼¸å…¥çš„éƒ¨åˆ†ï¼Œè€Œä¸‹åœ–æ˜¯æ•´å€‹æ¨¡å‹çš„æ¶æ§‹åœ–ã€‚</p>

<p><img src="./model_overview.png" alt="Model overview" /></p>

<h3 id="embedding-layer">Embedding Layer</h3>

<p>åœ¨é€™é‚Šæˆ‘å€‘æœƒçµ¦æ¯ä¸€å€‹userã€itemã€entityå’Œrelationä¸€å€‹embeddingï¼Œä¸éå› ç‚ºæˆ‘å€‘å·²ç¶“è½‰æ›æˆäº†knowledge graphçš„å½¢å¼ï¼Œæˆç‚ºäº†$(head, relation, tail)$çš„tripletå€‘ï¼Œæ‰€ä»¥åœ¨åº•ä¸‹ä¾¿æœƒç”¨$\mathbf{e}_h, \mathbf{e}_t \in \mathbb{R}^d$ä¾†ä»£è¡¨headå’Œtailçš„embeddingï¼Œç”¨$\mathbf{e}_r\in\mathbb{R}^k$ä¾†ä»£è¡¨relationçš„embeddingã€‚</p>

<p>åœ¨knowledge graphè£¡é¢æˆ‘å€‘æœƒéœ€è¦ä¸€å€‹ä¾†è¡¡é‡é€™å€‹tripletç›®å‰å­¸å¾—æ€éº¼æ¨£çš„åˆ†æ•¸ï¼Œè€Œé€™ç¯‡paperçš„å®šç¾©å¦‚ä¸‹</p>

\[g(h, r, t)=\left \| \mathbf{W}_r\mathbf{e}_h+\mathbf{e}_r-\mathbf{W}_r\mathbf{e}_t\right \|_2^2\]

<p>åœ¨ä¸Šé¢çš„$\mathbf{W}_r\in\mathbb{R}^{k\times d}$æ˜¯ä¸€å€‹transformation matrixï¼Œå¹«å¿™æŠŠheadå’Œtailçš„embeddingè½‰æ›åˆ°relationçš„ç©ºé–“ï¼Œä¸¦ç›´æ¥ç”¨headå’Œrelationå‘é‡ç›¸åŠ çš„ä½ç½®è·Ÿtailçš„ä½ç½®å·®ç•°ä¾†ç‚ºtripletæ‰“åˆ†æ•¸ï¼Œä¸€å€‹è¶Šå°çš„$g(h, r, t)$æ˜¯è¶Šå¥½çš„ã€‚</p>

<p>è€Œè¦è¨“ç·´çš„loss functionä¾¿æ˜¯å¸Œæœ›æœ‰å­˜åœ¨åœ¨graphè£¡é¢çš„tripletçš„$g(h, r, t)$è¦æ¯”éš¨æ©ŸæŠ½æ¨£çš„tail $tâ€™$çš„$g(h, r, tâ€™)$é‚„è¦ä¾†å¾—å°ã€‚</p>

\[\mathcal{L}_{KG}=\sum\limits_{(h, r, t, t') \in \tau}-\ln\sigma\left( g(h, r, t')-g(h, r, t) \right)\\ \tau=\{ (h, r, t, t')|(h, r, t)\in\mathcal{G}, (h, r, t')\notin\mathcal{G}\}\]

<p>ä¸Šé¢ç®—å¼ä¸­çš„$\sigma$æ˜¯sigmoid functionã€‚</p>

<h3 id="attentive-embedding-propagation-layers">Attentive Embedding Propagation Layers</h3>

<h4 id="information-propagation">Information Propagation</h4>

<p>åœ¨é€™ç¯‡paperè£¡é¢ï¼Œembeddingé™¤äº†è¢«ä¸Šé¢knowledge graphçš„gradientæ›´æ–°ä»¥å¤–ï¼Œé€™è£¡é‚„æœƒæ ¹æ“šé„°å±…çš„embeddingä¾†å½±éŸ¿æœ¬èº«çš„embeddingã€‚</p>

<p>å‡å¦‚ç¾åœ¨æœ‰ä¸€å€‹entity $h$ï¼Œå®ƒçš„é„°å±…å°±æ˜¯èˆ‡$h$ç›¸é„°çš„æ‰€æœ‰nodeï¼Œè€Œæˆ‘å€‘æŠŠé€™äº›é„°å±…æŒ‰ç…§é‡è¦æ€§weighted sumæˆä¸€å€‹å–®ä¸€çš„embedding $\mathbf{e}_{\mathcal{N}_h}$ã€‚</p>

\[\mathbf{e}_{\mathcal{N}_h}=\sum\limits_{(h, r, t)\in\mathcal{N}_h}\pi(h,r,t)\mathbf{e}_t\\ \mathcal{N}_h = \{(h, r, t) \vert (h, r, t) \in \mathcal{G} \}\]

<h4 id="knowledge-aware-attention">Knowledge-aware Attention</h4>

<p>åœ¨å¼$(3)$è£¡é¢çš„$\pi(h,r,t)$æ‰€å®šç¾©æ¯å€‹é„°å±…çš„é‡è¦ç¨‹åº¦æ˜¯ç”±åº•ä¸‹çš„å¼å­å®šç¾©å‡ºä¾†çš„</p>

\[\pi(h,r,t)=(\mathbf{W}_r\mathbf{e}_t)^\top\tanh\left((\mathbf{W}_r\mathbf{e}_h+\mathbf{e}_r)\right)\]

<p>åœ¨é€™é‚Šæˆ‘å€‘æŠŠentityå’Œå®ƒçš„é„°å±…é€étransformation matrixè½‰æ›åˆ°relationçš„ç©ºé–“ä»¥å¾Œï¼Œé€édot productä¾†ç®—å‡ºè·Ÿentity $h$çš„ç›¸é—œæ€§ä¾†è¡¨ç¤ºé„°å±…çš„é‡è¦ç¨‹åº¦ï¼Œæ¥è‘—å†åšnormalizeã€‚</p>

\[\pi(h, r, t)=\frac{\exp(\pi(h,r,t))}{\sum_{(h,r',t')\in\mathcal{N}_h}\exp(\pi(h,r',t'))}\]

<h4 id="information-aggregation">Information Aggregation</h4>

<p>åœ¨æœ‰äº†é„°å±…çš„embedding $\mathbf{e}_{\mathcal{N}_h}$ä»¥å¾Œï¼Œé€™ç¯‡paperæå‡ºäº†ä¸‰ç¨®functionä¾†æ›´æ–°åŸæœ¬çš„entity embedding $\mathbf{e}_h$ã€‚</p>

<ul>
  <li>GCN Aggregator</li>
</ul>

\[f_{GCN}=\mathrm{LeakyReLU}\left( \mathbf{W}(\mathbf{e}_h+\mathbf{e}_{\mathcal{N}_h}) \right)\]

<ul>
  <li>GraphSage Aggregator</li>
</ul>

\[f_{GraphSage}=\mathrm{LeakyReLU}\left( \mathbf{W}(\mathbf{e}_h\|\mathbf{e}_{\mathcal{N}_h})\right)\]

<ul>
  <li>Bi-Interaction Aggregator</li>
</ul>

\[f_{Bi-Interaction}=\mathrm{LeakyReLU}\left(\mathbf{W}_1(\mathbf{e}_h+\mathbf{e}_{\mathcal{N}_h})\right)+\mathrm{LeakyReLU}\left(\mathbf{W}_2(\mathbf{e}_h\odot\mathbf{e}_{\mathcal{N}_h})\right)\]

<p>ä¸Šé¢çš„$\mathbf{W}_1,\mathbf{W}_2\in\mathbb{R}^{dâ€™\times d}$æ˜¯å¯è¢«è¨“ç·´çš„åƒæ•¸ï¼Œè€Œ$\odot$æ˜¯element-wise productã€‚</p>

<h4 id="high-order-propagation">High-order Propagation</h4>

<p>åœ¨ä¸Šé¢æˆ‘å€‘å®šç¾©äº†å¦‚ä½•æŠŠentity $h$çš„é„°å±…çš„è³‡è¨Šæ•´åˆèµ·ä¾†è®Šæˆä¸€å€‹embeddingï¼Œä¹Ÿå®šç¾©äº†ä¸€äº›functionä¾†æ›´æ–°entity $h$çš„embeddingï¼Œè€Œé€™æ¨£çš„æ­¥é©Ÿå¯ä»¥é‡è¤‡å¾ˆå¤šæ¬¡ä¾†å¾—åˆ°å¤šå€‹embeddingè¡¨ç¤ºè·é›¢å¾è¿‘åˆ°é çš„è³‡è¨Šç¸½å’Œï¼Œé€™é‚Šå‡è¨­æˆ‘å€‘é‡è¤‡$l$æ¬¡ï¼Œæ¯æ¬¡entity $h$çš„embeddingç‚º</p>

\[\mathbf{e}^{(l)}_h=f\left(\mathbf{e}^{(l-1)}_h,\mathbf{e}^{(l-1)}_{\mathcal{N}_h}\right)\]

<p>è€Œé„°å±…çš„embeddingç‚º</p>

\[\mathbf{e}^{(l-1)}_{\mathcal{N}_h}=\sum\limits_{(h,r,t)\in\mathcal{N}_h}\pi(h,r,t)\mathbf{e}^{(l-1)}_t\]

<h3 id="model-prediction">Model Prediction</h3>

<p>åœ¨ç¶“éäº†$l$æ¬¡çš„æ“´æ•£ï¼Œä¹Ÿå°±æ˜¯$L$å±¤layerï¼ˆæ¯å€‹stepåœ¨information aggregationéƒ½å¯ä»¥æœ‰ä¸åŒçš„weightsï¼‰ä»¥å¾Œï¼Œæ¯å€‹user $u$æœƒæœ‰$L$å€‹embedding ${\mathbf{e}^{(1)}_u,â€¦,\mathbf{e}^{(L)}_u}$ï¼Œæ¯å€‹item $i$ä¹Ÿæœƒæœ‰$L$å€‹embedding ${\mathbf{e}^{(1)}_i,â€¦,\mathbf{e}^{(L)}_i}$ï¼Œæˆ‘å€‘æŠŠé€™äº›embeddingéƒ½concatenateèµ·ä¾†ç•¶åšæ˜¯æœ€çµ‚userå’Œitemçš„embeddingã€‚</p>

\[\mathbf{e}^*_u=\mathbf{e}^{(0)}_u\|...\|\mathbf{e}^{(L)}_u,\mathbf{e}^*_i=\mathbf{e}^{(0)}_i\|...\|\mathbf{e}^{(L)}_i\]

<p>è€Œæ•´å€‹æ¨è–¦ç³»çµ±çš„æ¨è–¦ä¾¿æ˜¯ä»¥userå’Œitem embeddingå…§ç©çš„çµæœå¤§å°ä¾†æ’åº</p>

\[\hat y(u,i)=\mathbf{e}^{*\top}_u\mathbf{e}^*_i\]

<h3 id="optimization">Optimization</h3>

<p>åœ¨loss functionçš„éƒ¨åˆ†é™¤äº†å¼$(2)$ knowledge graphçš„loss $\mathcal{L}_{KG}$ä»¥å¤–ï¼Œæˆ‘å€‘é‚„éœ€è¦æŠŠä½¿ç”¨è€…è·Ÿå•†å“äº’å‹•çš„éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯collaborative filterçš„lossæ”¾é€²å»</p>

\[\mathcal{L}_{CF}=\sum\limits_{(u,i,j)\in\mathcal{O}}-\ln\sigma\left(\hat y(u,i)-\hat y(u,j)\right)\\ \mathcal{O}=\{(u,i,j)\vert(u,i)\in\mathcal{R}^+,(u,j)\in\mathcal{R}^- \}\]

<p>å¼$(13)$è£¡é¢çš„$\mathcal{O}$æŒ‡çš„æ˜¯training dataï¼Œæ•´å€‹å¼å­çš„æ„æ€æ˜¯æœ‰å¯¦éš›äº’å‹•éçš„ä½¿ç”¨è€…å’Œå•†å“çš„çµ„åˆçš„åˆ†æ•¸è¦æ¯”æ²’æœ‰å¯¦éš›äº’å‹•éçš„çµ„åˆè¦ä¾†å¾—é«˜ã€‚</p>

<p>æ•´å€‹æ¨¡å‹çš„loss functionåˆèµ·ä¾†çš„æ¨£å­å¦‚ä¸‹</p>

\[\mathcal{L}_{KGAT}=\mathcal{L}_{KG}+\mathcal{L}_{CF}+\lambda\|\Theta\|^2_2\\ \Theta=\{\mathbf{E},\mathbf{W}_r,\forall l\in\mathcal{R},\mathbf{W}^{(l)}_1,\mathbf{W}^{(l)}_2,\forall l\in\{1,...,L\}\}\]

<p>å…¶ä¸­$\Theta$æ˜¯æ•´å€‹æ¨¡å‹çš„åƒæ•¸ï¼Œæœ€å¾Œä¸€é …æ˜¯ä¸€å€‹$L_2$çš„regularizationã€‚</p>

<h2 id="experiments">Experiments</h2>

<p>ä½œè€…å°‡é€™å€‹æ¨¡å‹å¥—ç”¨åœ¨ä¸‰å€‹datasetä¸Šï¼Œå…¶ç›¸é—œçš„çµ±è¨ˆæ•¸å€¼å¦‚ä¸‹ã€‚</p>

<p><img src="./dataset.png" alt="Dataset statistics" /></p>

<p>æ¨¡å‹è·‘å‡ºä¾†çš„çµæœå¦‚ä¸‹</p>

<p><img src="./performance.png" alt="Performance" /></p>

<p>å¯ä»¥çœ‹åˆ°KGATåœ¨å„å€‹datasetä¸Šé¢éƒ½æœ‰ä¸éŒ¯çš„è¡¨ç¾ã€‚</p>

<h2 id="conclusion">Conclusion</h2>

<p>é€™ç¯‡paperåœ¨collaborative filterä¸Šåˆå¤šåŠ äº†knowledge graphçš„è³‡è¨Šåœ¨è£¡é¢ï¼Œåœ¨å„å€‹datasetä¸Šçœ‹ç²å¾—äº†ä¸éŒ¯çš„çµæœï¼Œåœ¨paperä¸Šé¢ä¹Ÿæœ‰é™„ä¸Šå¯¦ä½œçš„<a href="https://github.com/xiangwang1223/knowledge_graph_attention_network">ç¨‹å¼ç¢¼</a>è®“å¤§å®¶è©¦è©¦çœ‹ã€‚</p>]]></content><author><name>Your Name</name></author><category term="Graph-Model" /><category term="Recommendation-System" /><category term="Machine-Learning" /><summary type="html"><![CDATA[é€™ç¯‡æ–‡ç« ç´€éŒ„ä¸€ä¸‹çœ‹äº†KGAT: Knowledge Graph Attention Network for Recommendationçš„ç­†è¨˜ã€‚]]></summary></entry><entry><title type="html">è‡ªå·±å»ºç«‹Overleafä¼ºæœå™¨</title><link href="https://wjohn1483.github.io/#%20the%20base%20hostname%20&%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/11/24/overleaf/" rel="alternate" type="text/html" title="è‡ªå·±å»ºç«‹Overleafä¼ºæœå™¨" /><published>2022-11-24T00:00:00+00:00</published><updated>2022-11-24T00:00:00+00:00</updated><id>https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/11/24/overleaf</id><content type="html" xml:base="https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/11/24/overleaf/"><![CDATA[<p>åœ¨éå»å¯«paperçš„æ™‚å€™é€šå¸¸éƒ½æ˜¯ä½¿ç”¨<a href="https://www.overleaf.com/">overleaf</a>ä¾†è·Ÿå¤§å®¶å…±åŒå”ä½œä¸¦æŠŠlatexç·¨è­¯æˆPDFï¼Œåœ¨å¶ç„¶çš„æ©Ÿæœƒç™¼ç¾åˆ°åŸä¾†overleafæ˜¯æœ‰é–‹æºçš„ç‰ˆæœ¬çš„ï¼Œåº•ä¸‹ä»‹ç´¹ä¸€ä¸‹å¦‚ä½•è‡ªè¡Œå»ºç«‹overleafçš„ä¼ºæœå™¨ã€‚</p>

<!--more-->

<h2 id="overleafä»‹ç´¹">Overleafä»‹ç´¹</h2>

<p>Overleafæ˜¯ä¸€å€‹ç·šä¸Šlatexçš„å…±åŒç·¨è¼¯å™¨ï¼Œæä¾›äº†ä¸€å€‹å¹³å°å¯ä»¥è®“å¤§å®¶åœ¨ä¸Šé¢å…±åŒç·¨è¼¯latexçš„æ–‡ä»¶ï¼Œèˆ‡æ­¤åŒæ™‚ä¹Ÿæ”¯æ´å¯¦æ™‚ç·¨è­¯å’Œç€è¦½çµæœï¼Œé©åˆå€‹äººæˆ–è€…åœ˜éšŠåœ¨è£½ä½œpaperã€æŠ•å½±ç‰‡æˆ–æ­£å¼æ–‡ä»¶çš„æ™‚å€™ä½¿ç”¨ã€‚</p>

<p>åœ¨<a href="https://www.overleaf.com/">overleaf</a>è£¡é¢é™¤äº†æœ‰ä¸Šè¿°åŠŸèƒ½ä»¥å¤–ï¼Œé‚„é¡å¤–æ•´åˆäº†gitä¾†åšç‰ˆæœ¬æ§åˆ¶ï¼Œä¹Ÿèƒ½ç›´æ¥åœ¨èªå¥ä¸­ç•™è¨€ï¼Œè€Œé–‹æºç‰ˆæœ¬çš„overleafåªæœ‰æ¯”è¼ƒåŸºæœ¬çš„å…±åŒç·¨è¼¯å’Œå¯¦æ™‚ç·¨è­¯çš„åŠŸèƒ½ã€‚</p>

<h2 id="å»ºç½®overleafä¼ºæœå™¨">å»ºç½®Overleafä¼ºæœå™¨</h2>

<p>è©³ç´°çš„èªªæ˜å¯ä»¥åƒè€ƒ<a href="https://github.com/overleaf/overleaf">é–‹æºç‰ˆæœ¬overleafçš„GitHub</a>ã€‚</p>

<h3 id="è¨­ç½®overleaf">è¨­ç½®Overleaf</h3>

<p>åœ¨å»ºç«‹ä¼ºæœå™¨ä¹‹å‰ï¼Œæˆ‘å€‘éœ€è¦å…ˆå°å®ƒé€²è¡Œä¸€äº›è¨­å®šï¼Œåƒæ˜¯è¦ä½¿ç”¨å“ªå€‹portå’ŒIPï¼Œåº•ä¸‹çš„æŒ‡ä»¤æœƒæŠŠoverleafç›¸é—œçš„ç¨‹å¼ç¢¼ä¸‹è¼‰ä¸‹ä¾†ï¼Œä¸¦ç”¢ç”Ÿä¸€äº›é è¨­çš„è¨­å®šæª”ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/overleaf/toolkit.git ./overleaf-toolkit
<span class="nb">cd</span> ./overleaf-toolkit
./bin/init
</code></pre></div></div>

<p>åŸ·è¡Œå®Œä¸Šé¢çš„æŒ‡ä»¤ä»¥å¾Œï¼Œæœƒåœ¨ç•¶å‰çš„ç›®éŒ„ä¸‹å»ºç«‹<code class="language-plaintext highlighter-rouge">./config/</code>çš„è³‡æ–™å¤¾ï¼Œå…¶ä¸­æˆ‘å€‘æ¯”è¼ƒéœ€è¦å¸¸å»ä¿®æ”¹çš„æ˜¯<strong>./config/overleaf.rc</strong>ï¼Œåœ¨è£¡é¢å°±èƒ½å»èª¿æ•´ä¼ºæœå™¨çš„IPå’Œportäº†ã€‚é è¨­çš„IPæ˜¯<code class="language-plaintext highlighter-rouge">127.0.0.1</code>ï¼Œå¦‚æœæƒ³è¦è®“åˆ¥äººå¯ä»¥å­˜å–çš„è©±ï¼Œè¨˜å¾—æŠŠè¨­å®šæ”¹æˆ<code class="language-plaintext highlighter-rouge">SHARELATEX_LISTEN_IP=0.0.0.0</code>æˆ–æ˜¯å…¶ä»–æƒ³è¦çš„IPã€‚</p>

<h3 id="é€édockerå»ºç«‹ä¼ºæœå™¨">é€éDockerå»ºç«‹ä¼ºæœå™¨</h3>

<p>åœ¨æª”æ¡ˆè£¡é¢æŠŠåƒæ•¸è¨­å®šå¥½ä»¥å¾Œï¼Œæˆ‘å€‘å°±èƒ½é–‹å§‹å»ºç«‹ä¼ºæœå™¨äº†ã€‚overleafæœ‰æä¾›docker imageè®“å¤§å®¶ç›´æ¥ä½¿ç”¨ï¼Œä½†æœƒéœ€è¦å…ˆå®‰è£dockerå’Œdocker-composeï¼Œdocker-composeå¯ä»¥ç›´æ¥é€épipä¾†å®‰è£ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip3 <span class="nb">install </span>docker-compose
</code></pre></div></div>

<p>æ¥è‘—å°±èƒ½åŸ·è¡Œåº•ä¸‹çš„æŒ‡ä»¤æŠŠä¼ºæœå™¨èµ·èµ·ä¾†äº†ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./bin/up
</code></pre></div></div>

<p>å¦‚æœæƒ³è¦æŠŠä¼ºæœå™¨åœæ‰ï¼Œå¯ä»¥ç›´æ¥ç”¨<code class="language-plaintext highlighter-rouge">Ctrl+C</code>åœæ‰ï¼Œè€Œåœæ‰å¾Œæƒ³è¦ç¹¼çºŒçš„è©±å¯ä»¥ç”¨startçš„æŒ‡ä»¤ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./bin/start
</code></pre></div></div>

<h3 id="å»ºç«‹adminå¸³è™Ÿ">å»ºç«‹Adminå¸³è™Ÿ</h3>

<p>ä¼ºæœå™¨èµ·ä¾†ä»¥å¾Œéœ€è¦å…ˆå»ºç«‹ä¸€å€‹adminå¸³è™Ÿï¼Œæ–¹ä¾¿ä¹‹å¾ŒæŠŠå…¶ä»–äººåŠ é€²ä¾†ä¸€åŒå”ä½œï¼Œå»ºç«‹adminçš„æ–¹æ³•æ˜¯ä½¿ç”¨ç€è¦½å™¨ç›´æ¥é€£ç·šåˆ°<a href="http://localhost/launchpad">http://localhost/launchpad</a>ï¼Œç…§è‘—æç¤ºè¼¸å…¥emailå’Œå¯†ç¢¼å°±è¡Œäº†ï¼Œè¨˜å¾—è¦å°‡ç¶²å€è£¡é¢çš„<code class="language-plaintext highlighter-rouge">localhost</code>æ”¹æˆä½ è¨­å®šçš„IPå’Œportã€‚</p>

<h2 id="é–‹å§‹ä½¿ç”¨overleaf">é–‹å§‹ä½¿ç”¨Overleaf</h2>

<p>æŠŠä¼ºæœå™¨é–‹èµ·ä¾†ä¸¦æœ‰äº†adminå¸³è™Ÿä»¥å¾Œï¼Œå°±èƒ½é–‹å§‹ä½¿ç”¨overleafä¾†ç·¨å¯«ç°¡å–®çš„latexæ–‡ä»¶äº†ï¼Œä½†å¦‚æœè¦åœ¨latexè£¡ä½¿ç”¨ä¸€äº›<code class="language-plaintext highlighter-rouge">\usepackage{}</code>çš„æ™‚å€™æœƒç™¼ç¾é€™äº›packageæ²’æœ‰è¢«å®‰è£ï¼ŒåŸå› æ˜¯å› ç‚ºoverleafæä¾›çš„docker imageåªåŒ…å«äº†æœ€åŸºæœ¬çš„å¥—ä»¶è€Œå·²ï¼Œç›®çš„æ˜¯ä¸æƒ³è¦docker imageå¤ªå¤§ä»¥æ¸›å°‘ä¸‹è¼‰imageéœ€è¦çš„æ™‚é–“ï¼Œå¦‚æœæƒ³è¦ç”¨<code class="language-plaintext highlighter-rouge">\usepackage{}</code>çš„è©±ï¼Œæˆ‘å€‘å¯ä»¥è‡ªå·±æ›´æ–°textliveã€‚</p>

<h3 id="æ›´æ–°textlive">æ›´æ–°textlive</h3>

<p>è©³ç´°çš„èªªæ˜å¯ä»¥åƒè€ƒ<a href="https://github.com/overleaf/toolkit/blob/master/doc/ce-upgrading-texlive.md">é€™é‚Šçš„æ–‡ä»¶</a>ã€‚</p>

<p>é¦–å…ˆï¼Œæˆ‘å€‘éœ€è¦å…ˆé€£é€²overleafçš„containerä¸­</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./bin/shell
</code></pre></div></div>

<p>æ¥è‘—å°±èƒ½é€é<code class="language-plaintext highlighter-rouge">tlmgr</code>ä¾†å®‰è£æƒ³è¦çš„å¥—ä»¶äº†ï¼Œ<code class="language-plaintext highlighter-rouge">tlmgr</code>çš„ä½¿ç”¨æ–¹å¼å¯ä»¥ä¸‹<code class="language-plaintext highlighter-rouge">tlmgr help</code>ä¾†çœ‹èªªæ˜æ–‡ä»¶</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># The following command is executed in the container</span>
<span class="c"># tlmgr install PACKAGE_YOU_WANT_TO_USE</span>
tlmgr <span class="nb">install </span>tikzlings tikzmarmots tikzducks
</code></pre></div></div>

<p>å¦‚æœèªªä¸æƒ³è¦ä¸€å€‹ä¸€å€‹æŠŠéœ€è¦çš„å¥—ä»¶å®‰è£é€²å»ï¼Œæƒ³ä¸€æ¬¡å®‰è£å…¨éƒ¨çš„è©±ï¼Œå¯ä»¥ä½¿ç”¨åº•ä¸‹çš„æŒ‡ä»¤</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># The following command is executed in the container</span>
tlmgr <span class="nb">install </span>scheme-full
</code></pre></div></div>

<p>åœ¨å®‰è£å®Œå¥—ä»¶ä»¥å¾Œï¼Œç†è«–ä¸Šå°±èƒ½åœ¨ä¼ºæœå™¨ä¸Šä½¿ç”¨è±å¯Œçš„packageäº†ï¼Œä½†é€™äº›packageåœ¨ä¸‹æ¬¡é‡æ–°å»ºç«‹containerçš„æ™‚å€™æœƒæ¶ˆå¤±ï¼Œå¦‚æœæˆ‘å€‘æƒ³è¦ä¿ç•™é€™å€‹æœ‰è±å¯Œå¥—ä»¶çš„containerï¼Œæˆ‘å€‘å¯ä»¥é€é<code class="language-plaintext highlighter-rouge">docker commit</code>çš„æ–¹å¼ä¾†ä¿å­˜ã€‚</p>

<p>é¦–å…ˆï¼Œæˆ‘å€‘å…ˆé€é<code class="language-plaintext highlighter-rouge">exit</code>æˆ–<code class="language-plaintext highlighter-rouge">Ctrl+D</code>ä¾†é›¢é–‹containerï¼Œæ¥è‘—ä¸‹åº•ä¸‹çš„æŒ‡ä»¤ä¾†å„²å­˜ä¸€å€‹commit</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker commit sharelatex sharelatex/sharelatex:with-texlive-full
</code></pre></div></div>

<p>ç„¶å¾Œåœ¨<code class="language-plaintext highlighter-rouge">./config/</code>åº•ä¸‹å»ºç«‹ä¸€å€‹<strong>docker-compose.override.yml</strong>çš„æª”æ¡ˆï¼Œåœ¨å…¶ä¸­è²¼ä¸Šåº•ä¸‹çš„å…§å®¹</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">2.2'</span>
<span class="na">services</span><span class="pi">:</span>
    <span class="na">sharelatex</span><span class="pi">:</span>
        <span class="na">image</span><span class="pi">:</span> <span class="s">sharelatex/sharelatex:with-texlive-full</span>
</code></pre></div></div>

<p>æœ€å¾Œå†åŸ·è¡Œåº•ä¸‹çš„æŒ‡ä»¤ä¾†é‡æ–°å»ºç«‹containerã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bin/stop <span class="o">&amp;&amp;</span> bin/docker-compose <span class="nb">rm</span> <span class="nt">-f</span> sharelatex <span class="o">&amp;&amp;</span> bin/up
</code></pre></div></div>

<h3 id="é–‹å¸³è™Ÿèˆ‡å…±äº«">é–‹å¸³è™Ÿèˆ‡å…±äº«</h3>

<p>åœ¨é–‹å®Œadminå¸³è™Ÿä¸¦å‰µç«‹å¥½projectä»¥å¾Œï¼Œæˆ‘å€‘å°±å¯ä»¥ç›´æ¥é€éç€è¦½å™¨å»å¹«å…¶ä»–äººé–‹å¸³è™Ÿä¸¦åˆ†äº«projectçµ¦ä»–å€‘ï¼Œé–‹å¸³è™Ÿçš„æ–¹å¼æ˜¯é»ç•«é¢å³ä¸Šè§’<code class="language-plaintext highlighter-rouge">Admin</code>åº•ä¸‹çš„<code class="language-plaintext highlighter-rouge">Manage Users</code></p>

<p><img src="./manage_users.png" alt="Manage users" /></p>

<p>åœ¨ä¸‹ä¸€å€‹ç•«é¢ä¸­æ‰“ä¸Šå°æ–¹çš„emailæŒ‰ä¸‹<code class="language-plaintext highlighter-rouge">Register</code>å¾Œï¼Œå°±èƒ½ç”¢ç”Ÿå•Ÿå‹•é€£çµ</p>

<p><img src="./register_new_users.png" alt="Register new users" /></p>

<p>è¨˜å¾—æŠŠå•Ÿå‹•é€£çµè£¡é¢çš„<code class="language-plaintext highlighter-rouge">localhost</code>æ›¿æ›æˆå‰é¢è¨­å®šçš„IPå’Œportä»¥å¾Œå‚³çµ¦å°æ–¹ï¼Œå°æ–¹å°±èƒ½é€éé€£çµè‡ªè¡Œè¨­å®šå¯†ç¢¼ä¾†å»ºç«‹å¸³è™Ÿã€‚</p>

<p>åœ¨projectå…§é¸æ“‡åˆ†äº«ä¸¦æ‰“ä¸Šå°æ–¹çš„emailï¼Œå°æ–¹å°±èƒ½åœ¨projectåˆ—è¡¨è£¡é¢çœ‹åˆ°é‚€è«‹é€šçŸ¥ï¼Œé»é–‹å°±èƒ½å…±åŒç·¨è¼¯åŒä¸€å€‹projectäº†ã€‚å¦‚æœæ˜¯æ–°å»ºç«‹çš„ä½¿ç”¨è€…ï¼Œæœƒéœ€è¦å…ˆå‰µå»ºä¸€å€‹ç©ºç™½çš„projectä»¥å¾Œæ‰èƒ½è·³è½‰åˆ°projectåˆ—è¡¨ä¸­ã€‚</p>]]></content><author><name>Your Name</name></author><category term="Tool" /><summary type="html"><![CDATA[åœ¨éå»å¯«paperçš„æ™‚å€™é€šå¸¸éƒ½æ˜¯ä½¿ç”¨overleafä¾†è·Ÿå¤§å®¶å…±åŒå”ä½œä¸¦æŠŠlatexç·¨è­¯æˆPDFï¼Œåœ¨å¶ç„¶çš„æ©Ÿæœƒç™¼ç¾åˆ°åŸä¾†overleafæ˜¯æœ‰é–‹æºçš„ç‰ˆæœ¬çš„ï¼Œåº•ä¸‹ä»‹ç´¹ä¸€ä¸‹å¦‚ä½•è‡ªè¡Œå»ºç«‹overleafçš„ä¼ºæœå™¨ã€‚]]></summary></entry><entry><title type="html">Tensorflow JSä»‹ç´¹</title><link href="https://wjohn1483.github.io/#%20the%20base%20hostname%20&%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/11/19/tensorflow-js-pose-detection/" rel="alternate" type="text/html" title="Tensorflow JSä»‹ç´¹" /><published>2022-11-19T00:00:00+00:00</published><updated>2022-11-19T00:00:00+00:00</updated><id>https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/11/19/tensorflow-js-pose-detection</id><content type="html" xml:base="https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/11/19/tensorflow-js-pose-detection/"><![CDATA[<p>éš¨è‘—æ©Ÿå™¨å­¸ç¿’çš„æ¨¡å‹å¯ä»¥åšåˆ°è¶Šä¾†è¶Šå¤šçš„äº‹æƒ…ï¼Œäººå€‘å¸Œæœ›å¯ä»¥åœ¨æ›´å¤šçš„å ´åŸŸä¾†ä½¿ç”¨æ©Ÿå™¨å­¸ç¿’çš„æ¨¡å‹ï¼Œä¹Ÿå› æ­¤å®ƒå€‘ä¹Ÿé€æ¼¸çš„è¢«éƒ¨ç½²åˆ°é™¤äº†é›»è…¦ä»¥å¤–çš„è£ç½®ä¸Šï¼Œé€™ç¯‡æ–‡ç« ä¸»è¦æ˜¯ä¾†ç°¡å–®ä»‹ç´¹ä¸€ä¸‹tensorflow.jsï¼ŒæŠŠæ¨¡å‹éƒ¨ç½²åœ¨ç€è¦½å™¨ä¸Šï¼Œè®“æ›´å¤šäººå¯ä»¥è¼•æ˜“åœ°å­˜å–ã€‚</p>

<!--more-->

<p>åœ¨é€™ç¯‡æ–‡ç« è£¡é¢ä¸»è¦æœƒä»‹ç´¹ä¸€ä¸‹tensorflow.jsçš„ä¸€äº›åŠŸèƒ½ï¼Œä¸¦èªªæ˜Googleåœ˜éšŠå…ˆå‰é€étensorflow.jsè£½ä½œçš„ä¸€å€‹æ‡‰ç”¨<a href="https://experiments.withgoogle.com/move-mirror">Move Mirror</a>å¤§æ¦‚æ˜¯å¦‚ä½•è¢«è£½ä½œå‡ºä¾†çš„ã€‚</p>

<h2 id="tensorflow-js">Tensorflow JS</h2>

<p><a href="https://www.tensorflow.org/js?hl=zh-tw">tensorflow.js</a>æ˜¯ä¸€å€‹JavaScriptçš„å¥—ä»¶ï¼Œè®“æ©Ÿå™¨å­¸ç¿’çš„æ¨¡å‹å¯ä»¥åœ¨ç€è¦½å™¨è£¡é¢è¢«åŸ·è¡Œï¼Œé™¤äº†å¯ä»¥æŠŠç”¨pythonè¨“ç·´å‡ºä¾†çš„æ¨¡å‹æ”¾åœ¨ç€è¦½å™¨ä¸Šä»¥å¤–ï¼Œé‚„å¯ä»¥ä½¿ç”¨å®˜æ–¹åŒ…å¥½çš„æ¨¡å‹ä¾†å»åšæœ‰è¶£çš„æ‡‰ç”¨ï¼Œå¯ä»¥åƒè€ƒ<a href="https://github.com/tensorflow/tfjs-examples">é€™é‚Šçš„ç¯„ä¾‹</a>ä¾†é–‹å§‹ç·¨å¯«tensorflow.jsã€‚</p>

<h2 id="pose-detection">Pose Detection</h2>

<p>åœ¨<a href="https://experiments.withgoogle.com/move-mirror">Move Mirror</a>è£¡é¢ï¼Œæˆ‘å€‘å¯ä»¥é€éä½¿ç”¨è€…çš„å‹•ä½œä¾†æ‰¾åˆ°ç›¸ä¼¼çš„åœ–ç‰‡ï¼Œä¸»è¦çš„æ–¹æ³•æ˜¯é€éCDCLçš„æ¨¡å‹ä¾†å»å°é›»è…¦é¡é ­æ‹æ”å‡ºä¾†çš„äººåƒåšè¾¨è­˜ï¼Œå¾ä¸­å–å¾—æ¯å€‹é—œç¯€çš„åº§æ¨™ï¼Œæ¥è‘—æŠŠåº§æ¨™æ­£è¦åŒ–ä»¥å¾Œå»è·Ÿç…§ç‰‡å»ç®—cosine similarityï¼Œè€Œåœ¨<a href="https://blog.tensorflow.org/2018/07/move-mirror-ai-experiment-with-pose-estimation-tensorflow-js.html">éƒ¨è½æ ¼æ–‡ç« </a>ç•¶ä¸­é‚„æœ‰è¬›è¿°æŠŠæ¨¡å‹çµ¦çš„ä¿¡å¿ƒåˆ†æ•¸æ”¾é€²ç®—åº§æ¨™è·é›¢çš„æ–¹æ³•å’Œå¿«é€Ÿè¨ˆç®—å¤šå¼µç…§ç‰‡çš„æ–¹å¼ï¼Œå»ºè­°é–±è®€æ–‡ç« çš„å…§å®¹ä¾†æ›´ç†è§£è©³ç´°çš„åšæ³•ã€‚</p>

<p>æœ‰äº†é€™å€‹CDCLæ¨¡å‹å’Œè·é›¢è¨ˆç®—çš„æ–¹å¼ï¼Œæˆ‘å€‘å¯ä»¥å°å®ƒç¨åšä¿®æ”¹ï¼Œæ”¹æˆçµ¦å®šä¸€å¼µç…§ç‰‡ï¼Œå»è¨ˆç®—é›»è…¦é¡é ­æ‹æ”çš„äººåƒå’Œç…§ç‰‡çš„è·é›¢æœ‰å¤šå°‘ï¼Œä¾†è®“ä½¿ç”¨è€…å¯ä»¥ç·´ç¿’æ“ºè·Ÿç…§ç‰‡ä¸€æ¨£çš„å§¿å‹¢ï¼Œæˆ‘å€‹äººä¿®æ”¹éå¾Œçš„çµæœå¯ä»¥<a href="https://wjohn1483.github.io/pose_copier/?model=movenet">åœ¨é€™é‚Šçœ‹åˆ°</a>ã€‚</p>]]></content><author><name>Your Name</name></author><category term="Tool" /><category term="Computer-Vision" /><summary type="html"><![CDATA[éš¨è‘—æ©Ÿå™¨å­¸ç¿’çš„æ¨¡å‹å¯ä»¥åšåˆ°è¶Šä¾†è¶Šå¤šçš„äº‹æƒ…ï¼Œäººå€‘å¸Œæœ›å¯ä»¥åœ¨æ›´å¤šçš„å ´åŸŸä¾†ä½¿ç”¨æ©Ÿå™¨å­¸ç¿’çš„æ¨¡å‹ï¼Œä¹Ÿå› æ­¤å®ƒå€‘ä¹Ÿé€æ¼¸çš„è¢«éƒ¨ç½²åˆ°é™¤äº†é›»è…¦ä»¥å¤–çš„è£ç½®ä¸Šï¼Œé€™ç¯‡æ–‡ç« ä¸»è¦æ˜¯ä¾†ç°¡å–®ä»‹ç´¹ä¸€ä¸‹tensorflow.jsï¼ŒæŠŠæ¨¡å‹éƒ¨ç½²åœ¨ç€è¦½å™¨ä¸Šï¼Œè®“æ›´å¤šäººå¯ä»¥è¼•æ˜“åœ°å­˜å–ã€‚]]></summary></entry><entry><title type="html">Python loggingä»‹ç´¹</title><link href="https://wjohn1483.github.io/#%20the%20base%20hostname%20&%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/06/04/python-logging-introduction/" rel="alternate" type="text/html" title="Python loggingä»‹ç´¹" /><published>2022-06-04T00:00:00+00:00</published><updated>2022-06-04T00:00:00+00:00</updated><id>https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/06/04/python-logging-introduction</id><content type="html" xml:base="https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/06/04/python-logging-introduction/"><![CDATA[<p>é€™ç¯‡æ–‡ç« ç°¡å–®ä»‹ç´¹ä¸€ä¸‹python loggingé€™å€‹packageçš„ä½¿ç”¨æ–¹æ³•ã€‚</p>

<!--more-->

<p>åœ¨pythonè£¡é¢æƒ³è¦å»debugä½ çš„ç¨‹å¼é™¤äº†ä½¿ç”¨<code class="language-plaintext highlighter-rouge">print()</code>ç›´æ¥æŠŠè®Šæ•¸å°å‡ºä¾†ä»¥å¤–ï¼Œå¯ä»¥ä½¿ç”¨åŸç”Ÿçš„<code class="language-plaintext highlighter-rouge">logging</code> packageä¾†å»æŠŠlogçµ¦å°å‡ºä¾†ã€‚</p>

<h2 id="logçš„åˆ†é¡">Logçš„åˆ†é¡</h2>

<p>åœ¨é–‹å§‹ä»‹ç´¹loggingæ€éº¼ä½¿ç”¨ä¹‹å‰ï¼Œæˆ‘å€‘å¯ä»¥å…ˆä¾†èªè­˜ä¸€ä¸‹logæœ‰åˆ†æˆä¸åŒçš„ç­‰ç´šï¼Œåœ¨<a href="https://docs.python.org/3/howto/logging.html#when-to-use-logging">pythonçš„æ–‡ä»¶</a>ä¸­æœ‰ä»‹ç´¹ä»€éº¼æ™‚å€™è©²ä½¿ç”¨å“ªç¨®æ–¹æ³•ä¾†é¡¯ç¤ºè¨Šæ¯ï¼Œåƒæ˜¯<code class="language-plaintext highlighter-rouge">print()</code>ä¸»è¦æ˜¯ç”¨ä¾†é¡¯ç¤ºusageç­‰ä¸€èˆ¬ç”¨é€”ï¼Œè€Œ<code class="language-plaintext highlighter-rouge">logging.warning()</code>æ˜¯è¡¨ç¤ºç™¼ç¾åˆ°æœ‰å•é¡Œï¼Œä½†ä¸¦ä¸å½±éŸ¿åŸ·è¡Œï¼Œè©³ç´°çš„ä»‹ç´¹å»ºè­°é–±è®€ä¸Šé¢çš„æ–‡ä»¶ï¼Œåº•ä¸‹ç°¡å–®ä»‹ç´¹ä¸€ä¸‹logçš„åˆ†ç´šã€‚</p>

<ul>
  <li>
    <p>DEBUGï¼šé¡¯ç¤ºè©³ç´°çš„è¨Šæ¯ï¼Œä¸»è¦æ˜¯åœ¨è¿½æŸ¥å•é¡Œçš„æ™‚å€™ä½¿ç”¨</p>
  </li>
  <li>
    <p>INFOï¼šé¡¯ç¤ºç¢ºèªçš„è¨Šæ¯ï¼Œè¡¨ç¤ºç¨‹å¼æœ‰æ­£ç¢ºåœ°åœ¨åŸ·è¡Œ</p>
  </li>
  <li>
    <p>WARNINGï¼šè¡¨ç¤ºæœ‰äº›é æ–™å¤–çš„äº‹æƒ…ç™¼ç”Ÿæˆ–é å‘Šå¯èƒ½çš„å•é¡Œåƒæ˜¯ç¡¬ç¢Ÿç©ºé–“å¿«ä¸å¤ äº†ï¼Œä½†ç¨‹å¼ä»å¯ä»¥ç¹¼çºŒåŸ·è¡Œ</p>
  </li>
  <li>
    <p>ERRORï¼šç¨‹å¼åŸ·è¡Œçš„éç¨‹ç•¶ä¸­ç¢°åˆ°äº†ä¸€äº›å•é¡Œï¼Œå¯èƒ½æœ‰äº›functionä¸èƒ½è¢«åŸ·è¡Œäº†</p>
  </li>
  <li>
    <p>CRITICALï¼šç¨‹å¼ç¢°åˆ°äº†æ›´åš´é‡çš„å•é¡Œï¼Œå·²ç¶“ç„¡æ³•ç¹¼çºŒåŸ·è¡Œ</p>
  </li>
</ul>

<h2 id="ç°¡å–®ä½¿ç”¨logging">ç°¡å–®ä½¿ç”¨logging</h2>

<p>åœ¨<code class="language-plaintext highlighter-rouge">logging</code>è£¡é¢æœ‰æ ¹æ“šä¸Šè¿°ä¸åŒç­‰ç´šçš„logæœ‰å°æ‡‰çš„functionå¯ä»¥å‘¼å«ï¼Œå¯ä»¥çœ‹åº•ä¸‹çš„ä¾‹å­</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logging</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="s">"Debug message"</span><span class="p">)</span>
<span class="n">logging</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Info message"</span><span class="p">)</span>
<span class="n">logging</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="s">"Warning message"</span><span class="p">)</span>
<span class="n">logging</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="s">"Error message"</span><span class="p">)</span>
<span class="n">logging</span><span class="p">.</span><span class="n">critical</span><span class="p">(</span><span class="s">"Critical message"</span><span class="p">)</span>
</code></pre></div></div>

<p>åœ¨å¯¦éš›åŸ·è¡Œä¸Šé¢çš„ç¨‹å¼ç¢¼ä»¥å¾Œæˆ‘å€‘å¯ä»¥å¾—åˆ°ä¸‹é¢çš„çµæœ</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>WARNING:root:Warning message
ERROR:root:Error message
CRITICAL:root:Critical message
</code></pre></div></div>

<p>åœ¨ä½¿ç”¨<code class="language-plaintext highlighter-rouge">logging</code>çš„functionæ™‚ï¼Œ<code class="language-plaintext highlighter-rouge">logging</code>æœƒå»å‰µå»ºä¸€å€‹åå«<code class="language-plaintext highlighter-rouge">root</code>çš„loggerï¼Œä¸¦æŠŠè¨Šæ¯é€éé€™å€‹loggerä¾†ç´€éŒ„ï¼Œè€Œå…¶é è¨­çš„æ ¼å¼æ˜¯<code class="language-plaintext highlighter-rouge">severity:logger name:message</code>ï¼Œè€Œä¸”åªæœƒé¡¯ç¤ºWARNINGä»¥ä¸Šçš„è¨Šæ¯ï¼Œå¦‚æœæƒ³è¦è¨­å®šé¡¯ç¤ºå“ªç¨®logçš„ç­‰ç´šçš„è©±ï¼Œå¯ä»¥åœ¨æœ€å‰é¢å‘¼å«<code class="language-plaintext highlighter-rouge">basicConcig()</code>ä¾†è¨­å®š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logging</span><span class="p">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">DEBUG</span><span class="p">)</span>
<span class="n">logging</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="s">"Debug message"</span><span class="p">)</span>
<span class="n">logging</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Info message"</span><span class="p">)</span>
<span class="n">logging</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="s">"Warning message"</span><span class="p">)</span>
<span class="n">logging</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="s">"Error message"</span><span class="p">)</span>
<span class="n">logging</span><span class="p">.</span><span class="n">critical</span><span class="p">(</span><span class="s">"Critical message"</span><span class="p">)</span>
</code></pre></div></div>

<p>æ­¤æ™‚å¾—åˆ°çš„çµæœæœƒæ˜¯</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DEBUG:root:Debug message
INFO:root:Info message
WARNING:root:Warning message
ERROR:root:Error message
CRITICAL:root:Critical message
</code></pre></div></div>

<p>é€™æ¨£çš„ä½œæ³•åœ¨ç•¶ç¨‹å¼ç¢¼è£¡é¢æœ‰å¼•å…¥å¤šå€‹moduleçš„æ™‚å€™ä¹Ÿé©ç”¨</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># main.py
</span><span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">lib</span> <span class="kn">import</span> <span class="n">func</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">logging</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"info from main"</span><span class="p">)</span>
    <span class="n">logging</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s">"error from main"</span><span class="p">)</span>
    <span class="n">func</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">logging</span><span class="p">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># lib.py
</span><span class="kn">import</span> <span class="nn">logging</span>


<span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
    <span class="n">logging</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"info from lib"</span><span class="p">)</span>
    <span class="n">logging</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s">"error from lib"</span><span class="p">)</span>
</code></pre></div></div>

<p>åœ¨ä¸Šé¢æˆ‘å€‘å¯«äº†å…©å€‹python scriptï¼Œåˆ†åˆ¥ç‚º<strong>main.py</strong>å’Œ<strong>lib.py</strong>ï¼Œå…¶ä¸­<strong>main.py</strong>æœƒå»å‘¼å«å®šç¾©åœ¨<strong>lib.py</strong>è£¡é¢çš„<code class="language-plaintext highlighter-rouge">func()</code>ï¼Œé€™æ™‚å¦‚æœå»åŸ·è¡Œ<strong>main.py</strong>çš„è©±æœƒå¾—åˆ°ä¸‹é¢çš„çµæœ</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>INFO:root:info from main
ERROR:root:error from main
INFO:root:info from lib
ERROR:root:error from lib
</code></pre></div></div>

<p>åœ¨<strong>lib.py</strong>è£¡é¢è¨­å®šçš„è¨Šæ¯ä¹Ÿä¸€æ¨£æœƒè¢«é¡¯ç¤ºå‡ºä¾†ï¼Œç„¶è€Œç¾ä¸­ä¸è¶³çš„æ˜¯ï¼Œå¦‚æœæˆ‘å€‘æ²’æœ‰ç‰¹æ„åœ¨logè£¡é¢ç•™ä¸‹è·Ÿæª”æ¡ˆæœ‰é—œçš„è¨Šæ¯çš„è©±ï¼Œå°±å¾ˆé›£å¾logè£¡é¢çœ‹å‡ºé€™å€‹æ˜¯å¾å“ªè£¡ç”¢ç”Ÿå‡ºä¾†çš„logäº†ï¼Œåº•ä¸‹æœƒä»‹ç´¹pythonæ–‡ä»¶ç•¶ä¸­æ¯”è¼ƒå»ºè­°ï¼Œç‚ºæ¯å€‹æª”æ¡ˆå»ºç«‹loggerçš„æ–¹æ³•ã€‚</p>

<h2 id="ä½¿ç”¨è¤‡æ•¸logger">ä½¿ç”¨è¤‡æ•¸logger</h2>

<p>åœ¨ä¸Šé¢æˆ‘å€‘ç¢°åˆ°äº†ç„¡æ³•è¾¨åˆ¥logæ˜¯å¾å“ªå€‹moduleç”¢ç”Ÿå‡ºä¾†çš„å•é¡Œï¼Œè€Œè§£æ±ºé€™å€‹å•é¡Œçš„<a href="https://docs.python.org/3/howto/logging.html#advanced-logging-tutorial">å»ºè­°åšæ³•</a>æ˜¯å°æ¯ä¸€å€‹moduleéƒ½å»ºç«‹å°ˆå±¬æ–¼ä»–å€‘çš„loggerï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨<code class="language-plaintext highlighter-rouge">logging.getLogger()</code>ä¾†å»ºç«‹loggerä»¥å¾Œï¼Œå†ç”¨loggerä¾†ç´€éŒ„æˆ‘å€‘çš„è¨Šæ¯ã€‚</p>

<p>é€™é‚Šæˆ‘å€‘æŠŠä¸Šé¢ä¾‹å­ä¸­çš„<code class="language-plaintext highlighter-rouge">logging</code>éƒ½æ›¿æ›æˆ<code class="language-plaintext highlighter-rouge">logger</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># main.py
</span><span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">lib</span> <span class="kn">import</span> <span class="n">func</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"info from main"</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s">"error from main"</span><span class="p">)</span>
    <span class="n">func</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">logging</span><span class="p">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># lib.py
</span><span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
    <span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"info from lib"</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s">"error from lib"</span><span class="p">)</span>
</code></pre></div></div>

<p>é€™é‚Šæˆ‘å€‘å°‡<code class="language-plaintext highlighter-rouge">__name__</code>å‚³å…¥<code class="language-plaintext highlighter-rouge">logging.getLogger()</code>ç•¶ä¸­ï¼Œé€™æ™‚loggingå°±æœƒå¹«æˆ‘å€‘å»ºç«‹ä¸€å€‹ä»¥<code class="language-plaintext highlighter-rouge">__name__</code>ç‚ºåç¨±çš„loggerï¼Œè€Œ<code class="language-plaintext highlighter-rouge">__name__</code>æœƒåœ¨pythonè£¡é¢è¢«ä»£æ›æˆæª”æ¡ˆåç¨±ï¼Œé€™æ™‚å†åŸ·è¡Œ<strong>main.py</strong>å°±èƒ½å¾—åˆ°ä»¥ä¸‹çš„çµæœ</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>INFO:__main__:info from main
ERROR:__main__:error from main
INFO:lib:info from lib
ERROR:lib:error from lib
</code></pre></div></div>

<p>å¦‚æ­¤ä¾¿èƒ½æ–¹ä¾¿åœ°çŸ¥é“é€™å€‹logæ˜¯å¾å“ªå€‹moduleç”¢ç”Ÿçš„äº†ã€‚</p>

<h2 id="loggerçš„éšå±¤">Loggerçš„éšå±¤</h2>

<p>åœ¨ä¸Šé¢çš„ä¾‹å­è£¡é¢æˆ‘å€‘å»ºç«‹äº†å…©å€‹loggerï¼Œåˆ†åˆ¥æ˜¯<code class="language-plaintext highlighter-rouge">__main__</code>å’Œ<code class="language-plaintext highlighter-rouge">lib</code>ï¼Œé€™å…©å€‹loggerä¸æœƒå„è‡ªå°‡è¨Šæ¯ç›´æ¥å°å‡ºä¾†ï¼Œè€Œæ˜¯å°‡è¨Šæ¯å‚³åˆ°ä»–å€‘ä¸Šå±¤çš„loggerï¼Œè®“ä¸Šå±¤loggerä¸­çš„handlerä¾†æ±ºå®šlogè¦æ€éº¼è¢«è™•ç†ï¼Œåœ¨é€™å€‹ä¾‹å­è£¡é¢å®ƒå€‘æœƒå°‡logå‚³çµ¦<code class="language-plaintext highlighter-rouge">root</code>é€™å€‹loggerï¼Œå†å»çœ‹<code class="language-plaintext highlighter-rouge">root</code>è£¡é¢çš„handlerçš„è¨­å®šä¾†å»åšè™•ç†ï¼Œè©³ç´°çš„è™•ç†æµç¨‹å¯ä»¥åƒè€ƒ<a href="https://docs.python.org/3/howto/logging.html#logging-flow">æ–‡ä»¶</a></p>

<p><img src="https://docs.python.org/3/_images/logging_flow.png" alt="Logging Flow" /></p>

<p>é›–ç„¶åœ¨ç¨‹å¼ç¢¼è£¡é¢çœ‹èµ·ä¾†æˆ‘å€‘æ²’æœ‰ç‚ºroot loggerè¨­å®šä»»ä½•handlerï¼Œä½†å…¶å¯¦åœ¨æˆ‘å€‘å‘¼å«<code class="language-plaintext highlighter-rouge">logging.basicConfig()</code>çš„æ™‚å€™å®ƒå°±æœƒ<a href="https://docs.python.org/dev/library/logging.html#logging.basicConfig">è‡ªå‹•å¹«æˆ‘å€‘å»ºç«‹å¥½</a>ï¼Œå¦‚æœæƒ³è¦è‡ªè¡Œè¨­å®šçš„è©±ä¹Ÿå¯ä»¥ä½¿ç”¨<code class="language-plaintext highlighter-rouge">logging.getLogger()</code>ï¼Œåœ¨å…¶ä¸­ä¸çµ¦ä»»ä½•çš„åƒæ•¸ä¾†æ‹¿åˆ°root loggerï¼Œæ¥è‘—å†é€é<code class="language-plaintext highlighter-rouge">logger.addHandler()</code>ä¾†å»æ–°å¢handlerã€‚</p>

<h2 id="logging-format">Logging Format</h2>

<p>å¦‚æœèªªæˆ‘å€‘æƒ³è¦è‡ªå®šç¾©é¡¯ç¤ºå‡ºä¾†çš„logçš„æ ¼å¼çš„è©±ï¼Œå¯ä»¥åœ¨<code class="language-plaintext highlighter-rouge">logging.basicConfig()</code>çš„åœ°æ–¹è¨­å®šroot loggerä¸­handlerå°å‡ºlogçš„æ ¼å¼ï¼Œå› ç‚ºåº•ä¸‹çš„loggeræœƒæŠŠlogå¾€ä¸Šå‚³çµ¦root loggerï¼Œæ‰€ä»¥åªéœ€è¦åœ¨root loggerä¸­è¨­å®šå¥½ï¼Œæ‰€æœ‰å°å‡ºä¾†çš„logéƒ½æœƒæ˜¯ä¸€æ¨£çš„æ ¼å¼ã€‚</p>

<p>å‡å¦‚æˆ‘å€‘åœ¨<strong>main.py</strong>è£¡é¢å¤šåŠ å€‹åƒæ•¸</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">lib</span> <span class="kn">import</span> <span class="n">func</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"info from main"</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s">"error from main"</span><span class="p">)</span>
    <span class="n">func</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">log_format</span><span class="o">=</span><span class="s">"%(asctime)s %(filename)s:%(lineno)d - %(message)s"</span>
    <span class="n">logging</span><span class="p">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">log_format</span><span class="p">)</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>

<p>è€Œ<strong>lib.py</strong>ç¶­æŒä¸è®Šï¼Œé€™æ™‚å°å‡ºä¾†çš„è¨Šæ¯å°±æœƒè®Šæˆ</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2022-06-04 23:02:58,775 main.py:8 - info from main
2022-06-04 23:02:58,775 main.py:9 - error from main
2022-06-04 23:02:58,775 lib.py:6 - info from lib
2022-06-04 23:02:58,775 lib.py:7 - error from lib
</code></pre></div></div>

<p>æ›´å¤šloggingæ”¯æ´çš„attributeï¼Œå¯ä»¥çœ‹å…¶<a href="https://docs.python.org/3/library/logging.html#logrecord-attributes">å®˜æ–¹æ–‡ä»¶</a>ã€‚</p>

<h3 id="åœ¨logä¸­åŠ å…¥é¡è‰²">åœ¨logä¸­åŠ å…¥é¡è‰²</h3>

<p>å¦‚æœæƒ³åœ¨terminalè£¡é¢è®“ä¸åŒç­‰ç´šçš„logæœ‰ä¸åŒé¡è‰²çš„è©±ï¼Œå¯ä»¥åƒè€ƒå¾<a href="https://stackoverflow.com/questions/384076/how-can-i-color-python-logging-output">é€™è£¡</a>æ”¹ç·¨è€Œä¾†çš„æ–¹æ³•ï¼Œå¯«ä¸€å€‹<strong>log.py</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># log.py
</span><span class="kn">import</span> <span class="nn">logging</span>


<span class="k">class</span> <span class="nc">CustomFormatter</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">Formatter</span><span class="p">):</span>
    <span class="n">grey</span> <span class="o">=</span> <span class="s">"</span><span class="se">\x1b</span><span class="s">[38;20m"</span>
    <span class="n">cyan</span> <span class="o">=</span> <span class="s">"</span><span class="se">\x1b</span><span class="s">[36;20m"</span>
    <span class="n">light_green</span> <span class="o">=</span> <span class="s">"</span><span class="se">\x1b</span><span class="s">[32;20m"</span>
    <span class="n">yellow</span> <span class="o">=</span> <span class="s">"</span><span class="se">\x1b</span><span class="s">[33;20m"</span>
    <span class="n">red</span> <span class="o">=</span> <span class="s">"</span><span class="se">\x1b</span><span class="s">[31;20m"</span>
    <span class="n">bold_red</span> <span class="o">=</span> <span class="s">"</span><span class="se">\x1b</span><span class="s">[31;1m"</span>
    <span class="n">reset</span> <span class="o">=</span> <span class="s">"</span><span class="se">\x1b</span><span class="s">[0m"</span>
    <span class="n">log_format</span> <span class="o">=</span> <span class="s">"%(asctime)s - %(name)s - %(levelname)s - %(message)s (%(filename)s:%(lineno)d)"</span>

    <span class="n">FORMATS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">logging</span><span class="p">.</span><span class="n">DEBUG</span><span class="p">:</span> <span class="n">light_green</span> <span class="o">+</span> <span class="n">log_format</span> <span class="o">+</span> <span class="n">reset</span><span class="p">,</span>
        <span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">:</span> <span class="n">cyan</span> <span class="o">+</span> <span class="n">log_format</span> <span class="o">+</span> <span class="n">reset</span><span class="p">,</span>
        <span class="n">logging</span><span class="p">.</span><span class="n">WARNING</span><span class="p">:</span> <span class="n">yellow</span> <span class="o">+</span> <span class="n">log_format</span> <span class="o">+</span> <span class="n">reset</span><span class="p">,</span>
        <span class="n">logging</span><span class="p">.</span><span class="n">ERROR</span><span class="p">:</span> <span class="n">red</span> <span class="o">+</span> <span class="n">log_format</span> <span class="o">+</span> <span class="n">reset</span><span class="p">,</span>
        <span class="n">logging</span><span class="p">.</span><span class="n">CRITICAL</span><span class="p">:</span> <span class="n">bold_red</span> <span class="o">+</span> <span class="n">log_format</span> <span class="o">+</span> <span class="n">reset</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="n">log_fmt</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">FORMATS</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">record</span><span class="p">.</span><span class="n">levelno</span><span class="p">)</span>
        <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">Formatter</span><span class="p">(</span><span class="n">log_fmt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">formatter</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>


<span class="n">root_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">getLogger</span><span class="p">()</span>
<span class="n">root_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">StreamHandler</span><span class="p">()</span>
<span class="n">root_handler</span><span class="p">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">CustomFormatter</span><span class="p">())</span>
<span class="n">root_logger</span><span class="p">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">root_handler</span><span class="p">)</span>
</code></pre></div></div>

<p>åœ¨ä¸Šé¢çš„ç¨‹å¼ç¢¼è£¡é¢æˆ‘å€‘è‡ªè¨‚äº†ä¸€å€‹formatterï¼Œä¸¦æ ¹æ“šä¸åŒç­‰ç´šçš„logåŠ å…¥ä¸åŒé¡è‰²çš„å‰ç¶´å’Œå¾Œç¶´ï¼Œè€Œä¸”åœ¨åº•ä¸‹ä¹Ÿè¨­å®šäº†root loggerçš„handlerï¼Œè¦ä½¿ç”¨çš„æ™‚å€™æˆ‘å€‘åœ¨æ–°çš„ç¨‹å¼ç¢¼è£¡é¢ç°¡å–®importå®ƒä¸¦è¨­å®šlevelå°±å¯ä»¥äº†</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># main.py
</span><span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">import</span> <span class="nn">log</span>
<span class="kn">from</span> <span class="nn">lib</span> <span class="kn">import</span> <span class="n">func</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">logger</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="s">"debug message"</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"info message"</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="s">"warning message"</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="s">"error message"</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="n">critical</span><span class="p">(</span><span class="s">"critical message"</span><span class="p">)</span>
    <span class="n">func</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">logging</span><span class="p">.</span><span class="n">getLogger</span><span class="p">().</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">DEBUG</span><span class="p">)</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>

<p>è·‘å‡ºä¾†çš„logå°±èƒ½æœ‰é¡è‰²äº†</p>

<p><img src="./colorful_log.png" alt="Colorful Log" /></p>

<p>ä¸éè¦å°å¿ƒçš„æ˜¯ï¼Œå¦‚æœæŠŠlogå¯«æˆæª”æ¡ˆçš„è©±ï¼Œé€™äº›é¡è‰²å‰ç¶´å’Œå¾Œç¶´éƒ½æœƒè¢«å¯«é€²æª”æ¡ˆè£¡é¢ï¼Œå»ºè­°è¦–æƒ…æ³ä¾†ä½¿ç”¨</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[32<span class="p">;</span>20m2022-06-09 18:20:41,750 - __main__ - DEBUG - debug message <span class="o">(</span>main.py:11<span class="o">)</span>[0m
[36<span class="p">;</span>20m2022-06-09 18:20:41,750 - __main__ - INFO - info message <span class="o">(</span>main.py:12<span class="o">)</span>[0m
[33<span class="p">;</span>20m2022-06-09 18:20:41,750 - __main__ - WARNING - warning message <span class="o">(</span>main.py:13<span class="o">)</span>[0m
[31<span class="p">;</span>20m2022-06-09 18:20:41,750 - __main__ - ERROR - error message <span class="o">(</span>main.py:14<span class="o">)</span>[0m
[31<span class="p">;</span>1m2022-06-09 18:20:41,750 - __main__ - CRITICAL - critical message <span class="o">(</span>main.py:15<span class="o">)</span>[0m
[36<span class="p">;</span>20m2022-06-09 18:20:41,750 - lib - INFO - info from lib <span class="o">(</span>lib.py:8<span class="o">)</span>[0m
[31<span class="p">;</span>20m2022-06-09 18:20:41,750 - lib - ERROR - error from lib <span class="o">(</span>lib.py:9<span class="o">)</span>[0m
</code></pre></div></div>]]></content><author><name>Your Name</name></author><category term="Tool" /><category term="Python" /><summary type="html"><![CDATA[é€™ç¯‡æ–‡ç« ç°¡å–®ä»‹ç´¹ä¸€ä¸‹python loggingé€™å€‹packageçš„ä½¿ç”¨æ–¹æ³•ã€‚]]></summary></entry><entry><title type="html">MLflowä»‹ç´¹</title><link href="https://wjohn1483.github.io/#%20the%20base%20hostname%20&%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/05/29/mlflow-introduction/" rel="alternate" type="text/html" title="MLflowä»‹ç´¹" /><published>2022-05-29T00:00:00+00:00</published><updated>2022-05-29T00:00:00+00:00</updated><id>https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/05/29/mlflow-introduction</id><content type="html" xml:base="https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/05/29/mlflow-introduction/"><![CDATA[<p>éš¨è‘—æ©Ÿå™¨å­¸ç¿’çš„èˆˆèµ·ï¼Œæœ‰è¶Šä¾†è¶Šå¤šäººå˜—è©¦å¼•å…¥MLOpsåœ¨ç³»çµ±ç•¶ä¸­ï¼Œé€™ç¯‡æ–‡ç« ç°¡å–®ä»‹ç´¹ä¸€ä¸‹MLflowçš„ä½¿ç”¨å¿ƒå¾—ã€‚</p>

<!--more-->

<h2 id="mlops">MLOps</h2>

<p>åœ¨é–‹å§‹ä»‹ç´¹MLflowä¹‹å‰å…ˆç°¡å–®ä»‹ç´¹ä¸€ä¸‹MLOpsæƒ³è¦åšçš„äº‹æƒ…ï¼ŒMLOpså¯ä»¥èªªè·ŸDevOpsä¸€æ¨£æ˜¯ä¸€ç¨®ç²¾ç¥ï¼Œä¸»è¦æ˜¯å¸Œæœ›èƒ½è®“Machine Learningè·ŸOperationsèƒ½å¤ åˆä½œçš„æ›´èæ´½ï¼Œé€™é‚ŠMachine Learningçš„éƒ¨åˆ†åŒ…å«äº†å°è³‡æ–™æ¸…ç†ã€å»ºç«‹ä¸¦è¨“ç·´æ¨¡å‹ã€é©—è­‰æ¨¡å‹æˆæ•ˆç­‰ç­‰çš„äº‹æƒ…ï¼Œè€ŒOperationsæŒ‡çš„æ˜¯æŠŠæ¨¡å‹éƒ¨ç½²åˆ°ç³»çµ±è£¡é¢é€²è¡Œé æ¸¬ã€‚</p>

<p><img src="https://cloud.google.com/architecture/images/mlops-continuous-delivery-and-automation-pipelines-in-machine-learning-2-manual-ml.svg" alt="MLOps Manual Process" /></p>

<p><em><a href="https://cloud.google.com/architecture/mlops-continuous-delivery-and-automation-pipelines-in-machine-learning#devops_versus_mlops">MLOps: Continuous delivery and automation pipelines in machine learning</a></em></p>

<p>ä¸Šåœ–æ˜¯ä¸€å€‹ç°¡å–®çš„pipelineï¼Œå·¦åŠé‚ŠMLçš„éƒ¨åˆ†æ˜¯ä¸€èˆ¬machine learningçš„æµç¨‹ï¼ŒåŒ…å«äº†è³‡æ–™è™•ç†å’Œå»ºç«‹æ¨¡å‹çš„éç¨‹ï¼Œè€Œæœ€çµ‚ç”¢ç”Ÿçš„æ¨¡å‹æœƒæ”¾é€²model registryè£¡é¢ï¼ŒOperationså†å¾model registryè£¡é¢æŠŠæ¨¡å‹æ‹¿å‡ºä¾†åšservingã€‚</p>

<p>é€™å€‹pipelineç°¡å–®æœ‰æ•ˆï¼Œä½†å¦‚æœæœªä¾†æœ‰æ–°çš„è³‡æ–™é€²ä¾†æˆ–æ˜¯æ¨¡å‹çš„æˆæ•ˆé–‹å§‹ä¸‹é™ç­‰å¯èƒ½æœƒéœ€è¦é‡æ–°è¨“ç·´çš„æ¨¡å‹çš„æƒ…æ³ç™¼ç”Ÿçš„è©±ï¼ŒOperationså°±æœƒéœ€è¦å†è«‹MLçš„äººå¹«å¿™è¨“ç·´æ¨¡å‹ï¼Œç‚ºæ­¤å¦ä¸€å€‹æ¯”è¼ƒç©©å®šçš„pipelineå¯ä»¥æ˜¯å¦‚ä¸‹åœ–ã€‚</p>

<p><img src="https://cloud.google.com/architecture/images/mlops-continuous-delivery-and-automation-pipelines-in-machine-learning-3-ml-automation-ct.svg" alt="MLOps Pipeline Automation" /></p>

<p><em><a href="https://cloud.google.com/architecture/mlops-continuous-delivery-and-automation-pipelines-in-machine-learning#devops_versus_mlops">MLOps: Continuous delivery and automation pipelines in machine learning</a></em></p>

<p>åœ¨é€™å€‹pipelineè£¡é¢ï¼ŒMLæ‰€äº¤ä»˜çš„ä¸å†æ˜¯ä¸€å€‹æ¨¡å‹ï¼Œè€Œæ˜¯ç”¢ç”Ÿå‡ºé€™å€‹æ¨¡å‹çš„pipelineï¼ŒåŒ…å«äº†è³‡æ–™é©—è­‰ã€æ¸…ç†ã€å»ºç«‹æ¨¡å‹ã€é©—è­‰æ¨¡å‹ç­‰ï¼Œè€ŒOperationsæœƒå°‡é€™å€‹pipelineéƒ¨ç½²åˆ°ç³»çµ±è£¡é¢è‡ªè¡Œå»ç”¢ç”Ÿæ¨¡å‹å‡ºä¾†ï¼Œå¦‚æœèªªæœ‰æ–°çš„è³‡æ–™æˆ–æ˜¯æœ‰éœ€è¦é‡æ–°è¨“ç·´æ¨¡å‹çš„æƒ…æ³ç™¼ç”Ÿï¼ŒOperationså°±èƒ½ç›´æ¥é‡è·‘é€™å€‹pipelineä¾†å¾—åˆ°æ–°çš„æ¨¡å‹ã€‚</p>

<p>ç„¶è€Œè¦å»ºç«‹é€™ç¨®pipelineæœƒéœ€è¦èŠ±è²»è »å¤šå·¥å¤«çš„ï¼Œè€ŒMLflowå¯ä»¥å¹«åŠ©æˆ‘å€‘é™ä½ä¸€äº›å»ºç«‹é€™ç¨®pipelineçš„å›°é›£ã€‚</p>

<h2 id="mlflow">MLflow</h2>

<p><a href="https://mlflow.org/">MLflow</a>æ˜¯ä¸€å€‹é–‹æºçš„å¹³å°ï¼Œä¸»è¦æ˜¯æ‡‰ç”¨åœ¨machine learning lifecycleç•¶ä¸­ï¼ŒMLflowåŒ…å«äº†å››å€‹éƒ¨åˆ†</p>

<ul>
  <li>
    <p>Trackingï¼šç”¨ä»¥è¨˜éŒ„åœ¨è¨“ç·´æ¨¡å‹æ˜¯æ‰€ä½¿ç”¨çš„åƒæ•¸å’Œè¨“ç·´éç¨‹ä¸­çš„ä¸€äº›metrics</p>
  </li>
  <li>
    <p>Projectsï¼šè®“ä½¿ç”¨è€…å¯ä»¥å»ºç«‹ä¸€å¥—pipelineä¾†è®“å…¶ä»–äººå¯ä»¥è¼•æ˜“åœ°é‡ç¾å‡ºæ¨¡å‹</p>
  </li>
  <li>
    <p>Modelsï¼šæŠŠæ¨¡å‹åŒ…è£èµ·ä¾†ï¼Œåœ¨è£¡é¢æœƒç´€éŒ„è®“æ¨¡å‹é‹è¡Œæ‰€éœ€è¦çš„ç’°å¢ƒå’Œæ¨¡å‹æœ¬èº«ï¼Œè®“å…¶ä»–äººæ–¹ä¾¿ç›´æ¥ä½¿ç”¨æ¨¡å‹</p>
  </li>
  <li>
    <p>Registryï¼šå­˜æ”¾æ¨¡å‹ä¸¦æ”¯æ´ç‰ˆæœ¬æ§åˆ¶</p>
  </li>
</ul>

<p>åº•ä¸‹çš„æ–‡ç« å°‡æœƒç°¡è¿°ä¸€ä¸‹Trackingå’ŒProjectsçš„éƒ¨åˆ†ã€‚</p>

<h3 id="mlflow-tracking">MLflow Tracking</h3>

<p>æˆ‘å€‘å…ˆå¿«é€Ÿçœ‹ä¸€ä¸‹åº•ä¸‹çš„ç¨‹å¼ç¢¼</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">mlflow</span> <span class="kn">import</span> <span class="n">log_metric</span><span class="p">,</span> <span class="n">log_param</span><span class="p">,</span> <span class="n">log_artifact</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="c1"># Log a parameter (key-value pair)
</span>    <span class="n">log_param</span><span class="p">(</span><span class="s">"param1"</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
    <span class="n">log_param</span><span class="p">(</span><span class="s">"param2"</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="c1"># Log a metric; metrics can be updated throughout the run
</span>    <span class="n">log_metric</span><span class="p">(</span><span class="s">"foo"</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">log_metric</span><span class="p">(</span><span class="s">"foo"</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">log_metric</span><span class="p">(</span><span class="s">"foo"</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="c1"># Log an artifact (output file)
</span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"output1.txt"</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"first file!"</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"output2.txt"</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"second file!"</span><span class="p">)</span>
    <span class="n">log_artifact</span><span class="p">(</span><span class="s">"output1.txt"</span><span class="p">)</span>
    <span class="n">log_artifact</span><span class="p">(</span><span class="s">"output2.txt"</span><span class="p">)</span>
</code></pre></div></div>

<p>åœ¨ä¸Šé¢çš„ç¨‹å¼ç¢¼ä¸­æˆ‘å€‘å¯ä»¥çœ‹åˆ°mlflowæä¾›äº†ä¸‰ç¨®ä¸åŒlogçš„functionï¼Œ<code class="language-plaintext highlighter-rouge">log_param</code>ç”¨ä¾†è¨˜éŒ„é€™æ¬¡è¨“ç·´æ¨¡å‹æ™‚æ‰€ä½¿ç”¨çš„hyperparametersåƒæ˜¯learning rateã€batch sizeç­‰ç­‰ï¼Œè€Œ<code class="language-plaintext highlighter-rouge">log_metric</code>ç”¨ä¾†è¨˜éŒ„è¨“ç·´æ¨¡å‹ä¸­æœƒè®Šå‹•çš„è³‡æ–™ï¼Œåƒæ˜¯lossã€accuracyç­‰ï¼Œæœ€å¾Œ<code class="language-plaintext highlighter-rouge">log_artifact</code>æœƒæŠŠè©²è·¯å¾‘çš„æª”æ¡ˆæ”¾é€²artifactä¸­ï¼Œä¸»è¦æ˜¯æŠŠé€™æ¬¡è¨“ç·´å®Œæˆä»¥å¾Œæƒ³è¦ç•™å­˜çš„æª”æ¡ˆå„²å­˜ä¸‹ä¾†ï¼Œåƒæ˜¯æ¨¡å‹æœ¬èº«ã€å‰è™•ç†/å¾Œè™•ç†ç”¨åˆ°çš„å­—å…¸æª”ç­‰ã€‚</p>

<p>æœ‰äº†é€™äº›functionä»¥å¾Œï¼Œæˆ‘å€‘å°±èƒ½åœ¨ç·¨å¯«ç¨‹å¼çš„æ™‚å€™æŠŠé€™äº›functionå®‰æ’é€²ä¾†ï¼Œä¹‹å¾Œå°±èƒ½åœ¨command lineä¸Šé¢ä¸‹<code class="language-plaintext highlighter-rouge">mlflow server</code>çš„æŒ‡ä»¤ä¾†æ‰“é–‹mlflowçš„UIä¾†æª¢è¦–è¨“ç·´çš„æˆæœï¼Œç„¶è€Œæ¯æ¬¡æ‰‹å‹•å¯«é€™äº›functionæœ‰é»éº»ç…©ï¼Œmlflowæœ‰å¦å¤–æä¾›äº†auto trackingçš„åŠŸèƒ½ï¼Œåªéœ€è¦åœ¨ç¨‹å¼ç¢¼è£¡é¢åŠ å€‹å¹¾è¡Œï¼Œmlflowå°±æœƒå¹«ä½ è‡ªå‹•ç´€éŒ„é€™äº›åƒæ•¸å’Œçµæœäº†ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""Trains and evaluate a simple MLP
on the Reuters newswire topic classification task.
"""</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.datasets</span> <span class="kn">import</span> <span class="n">reuters</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">Activation</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.preprocessing.text</span> <span class="kn">import</span> <span class="n">Tokenizer</span>

<span class="c1"># The following import and function call are the only additions to code required
# to automatically log metrics and parameters to MLflow.
</span><span class="kn">import</span> <span class="nn">mlflow.keras</span>

<span class="n">mlflow</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">autolog</span><span class="p">()</span>

<span class="n">max_words</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">5</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Loading data..."</span><span class="p">)</span>
</code></pre></div></div>

<p><em><a href="https://github.com/mlflow/mlflow/blob/master/examples/keras/train.py">mlflow/examples/keras/train.py</a></em></p>

<p>åœ¨ä¸Šé¢æ˜¯ä¸€å€‹ç”¨kerasè¨“ç·´æ¨¡å‹çš„ç¯„ä¾‹ï¼Œåœ¨è£¡é¢æˆ‘å€‘åªéœ€è¦åŠ å…¥<code class="language-plaintext highlighter-rouge">import mlflow.keras</code>ã€<code class="language-plaintext highlighter-rouge">mlflow.keras.autolog()</code>é€™å…©è¡Œå°±èƒ½è®“mlflowå¹«æˆ‘å€‘ç´€éŒ„åƒæ•¸äº†ã€‚</p>

<p><img src="./mlflow_keras.png" alt="MLflow Keras" /></p>

<h3 id="mlflow-projects">MLflow Projects</h3>

<p>å‡å¦‚æˆ‘å€‘æƒ³è¦åˆ†äº«æˆ‘å€‘è¨“ç·´æ¨¡å‹æ‰€åšçš„æ‰€æœ‰æ­¥é©Ÿï¼Œæˆ‘å€‘å¯ä»¥å¯«ä¸€å€‹<code class="language-plaintext highlighter-rouge">MLproject</code>çš„æª”æ¡ˆï¼Œä¾†è®“å…¶ä»–äººå¯ä»¥ç°¡å–®ä¸‹ä¸€å€‹æŒ‡ä»¤<code class="language-plaintext highlighter-rouge">mlflow run .</code>å°±èƒ½é‡ç¾æ¨¡å‹è¨“ç·´çš„çµæœã€‚</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">mnist-autolog-example</span>

<span class="na">conda_env</span><span class="pi">:</span> <span class="s">conda.yaml</span>

<span class="na">entry_points</span><span class="pi">:</span>
  <span class="na">main</span><span class="pi">:</span>
    <span class="na">parameters</span><span class="pi">:</span>
      <span class="na">max_epochs</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">type</span><span class="pi">:</span> <span class="nv">int</span><span class="pi">,</span> <span class="nv">default</span><span class="pi">:</span> <span class="nv">5</span><span class="pi">}</span>
      <span class="na">gpus</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">type</span><span class="pi">:</span> <span class="nv">int</span><span class="pi">,</span> <span class="nv">default</span><span class="pi">:</span> <span class="nv">0</span><span class="pi">}</span>
      <span class="na">strategy</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">type str</span><span class="pi">,</span> <span class="nv">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">None"</span><span class="pi">}</span>
      <span class="na">batch_size</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">type</span><span class="pi">:</span> <span class="nv">int</span><span class="pi">,</span> <span class="nv">default</span><span class="pi">:</span> <span class="nv">64</span><span class="pi">}</span>
      <span class="na">num_workers</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">type</span><span class="pi">:</span> <span class="nv">int</span><span class="pi">,</span> <span class="nv">default</span><span class="pi">:</span> <span class="nv">3</span><span class="pi">}</span>
      <span class="na">learning_rate</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">type</span><span class="pi">:</span> <span class="nv">float</span><span class="pi">,</span> <span class="nv">default</span><span class="pi">:</span> <span class="nv">0.001</span><span class="pi">}</span>
      <span class="na">patience</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">type int</span><span class="pi">,</span> <span class="nv">default</span><span class="pi">:</span> <span class="nv">3</span><span class="pi">}</span>
      <span class="na">mode</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">type str</span><span class="pi">,</span> <span class="nv">default</span><span class="pi">:</span> <span class="s1">'</span><span class="s">min'</span><span class="pi">}</span>
      <span class="na">verbose</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">type bool</span><span class="pi">,</span> <span class="nv">default</span><span class="pi">:</span> <span class="nv">True</span><span class="pi">}</span>
      <span class="na">monitor</span><span class="pi">:</span> <span class="pi">{</span><span class="nv">type str</span><span class="pi">,</span> <span class="nv">default</span><span class="pi">:</span> <span class="s1">'</span><span class="s">val_loss'</span><span class="pi">}</span>

    <span class="na">command</span><span class="pi">:</span> <span class="pi">|</span>
          <span class="s">python mnist_autolog_example.py \</span>
            <span class="s">--max_epochs {max_epochs} \</span>
            <span class="s">--gpus {gpus} \</span>
            <span class="s">--strategy {strategy} \</span>
            <span class="s">--batch_size {batch_size} \</span>
            <span class="s">--num_workers {num_workers} \</span>
            <span class="s">--lr {learning_rate} \</span>
            <span class="s">--es_patience {patience} \</span>
            <span class="s">--es_mode {mode} \</span>
            <span class="s">--es_verbose {verbose} \</span>
            <span class="s">--es_monitor {monitor}</span>
</code></pre></div></div>

<p><em><a href="https://github.com/mlflow/mlflow/blob/master/examples/pytorch/MNIST/MLproject">mlflow/examples/pytorch/MNIST/MLproject</a></em></p>

<p>MLflowåœ¨è®€å–é€™å€‹æª”æ¡ˆçš„æ™‚å€™æœƒå…ˆåœ¨condaè£¡é¢å»ºç«‹ä¸€å€‹virtual environmentï¼Œä¸¦æŒ‰ç…§<code class="language-plaintext highlighter-rouge">conda.yaml</code>çš„è¨­å®šä¾†å»å®‰è£packageå€‘ï¼Œæ¥ä¸‹ä¾†æœƒå»åŸ·è¡Œentry_pointsè£¡é¢<code class="language-plaintext highlighter-rouge">main</code>çš„éƒ¨åˆ†ï¼Œå¦‚æœèªªæƒ³è¦ä½¿ç”¨ä¸åŒçš„åƒæ•¸è©¦è©¦çœ‹çš„è©±ï¼Œå¯ä»¥ä½¿ç”¨<code class="language-plaintext highlighter-rouge">mlflow run . -P PARAM=VALUE</code>çš„æ–¹å¼ä¾†å»æ›¿æ›æ‰é è¨­å€¼ã€‚</p>

<p>å¦‚æœåœ¨æ•´å€‹pipelineä¸­é‚„æœ‰å…¶ä»–è³‡æ–™è™•ç†æˆ–æ¨¡å‹é©—è­‰çš„æ­¥é©Ÿï¼Œå¯ä»¥åƒè€ƒ<a href="https://github.com/mlflow/mlflow/tree/master/examples/multistep_workflow">multistep_workflow</a>çš„ç¯„ä¾‹ã€‚</p>

<h2 id="çµè«–">çµè«–</h2>

<p>è¦æŠŠæ•´å€‹pipelineåŒ…è£æˆå¯é‡è¤‡åŸ·è¡Œçš„ç¨‹å¼ç¢¼é‚„æ˜¯éœ€è¦è »å¤šå·¥å¤«çš„ï¼Œå¥½åœ¨MLflowå¯ä»¥å¹«æˆ‘å€‘çœå»ä¸€äº›ï¼Œè€Œä¸”å…¶auto trackingçš„åŠŸèƒ½ä¹Ÿå¾ˆé©åˆåœ¨åšå¯¦é©—çš„éç¨‹ç•¶ä¸­ä¾†ä½¿ç”¨ã€‚</p>

<p>å¦å¤–åœ¨å¯¦ä½œçš„éç¨‹ç•¶ä¸­å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¦‚æœæƒ³è¦åœ¨auto trackingç•¶ä¸­å¦å¤–æ‰‹å‹•å­˜å…¥å…¶ä»–artifactï¼Œéœ€è¦æŠŠ<code class="language-plaintext highlighter-rouge">log_artifact</code>é€™å€‹functionæ”¾åœ¨åŒä¸€å€‹runè£¡é¢</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="n">mlflow</span><span class="p">.</span><span class="n">start_run</span><span class="p">()</span> <span class="k">as</span> <span class="n">run</span><span class="p">:</span>
    <span class="n">mlflow</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">autolog</span><span class="p">()</span>
    <span class="c1"># Training
</span>    <span class="n">mlflow</span><span class="p">.</span><span class="n">log_artifact</span><span class="p">(</span><span class="s">"PATH_TO_ARTIFACT"</span><span class="p">)</span>
</code></pre></div></div>

<p>è€Œåœ¨pipelineè™•ç†çš„éç¨‹ä¸­ï¼Œå‡å¦‚èªªæˆ‘å€‘æœ‰å€‹entry pointæ˜¯è™•ç†è³‡æ–™ã€å¦ä¸€å€‹entry pointæ˜¯è¨“ç·´æ¨¡å‹ï¼Œæˆ‘å€‘æ‡‰è©²æœƒå¸Œæœ›æ¯æ¬¡pipelineè·‘èµ·ä¾†ä¾¿å»æª¢æŸ¥è³‡æ–™æ˜¯å¦å·²ç¶“è™•ç†å¥½äº†ï¼Œå¦‚æœå·²ç¶“è™•ç†å¥½å°±ç›´æ¥è·‘è¨“ç·´æ¨¡å‹çš„éƒ¨åˆ†å°±å¥½ï¼Œæˆ‘ç›®å‰é‚„æ²’æœ‰åœ¨MLflowçœ‹åˆ°æ¯”è¼ƒå¥½çš„çœ‹æœ‰æ²’æœ‰åŸ·è¡ŒéæŸå€‹entry pointçš„æ–¹æ³•ï¼Œå¯èƒ½é‚„æ˜¯éœ€è¦åƒå‰é¢<a href="https://github.com/mlflow/mlflow/tree/master/examples/multistep_workflow">multistep_workflow</a>çš„ç¯„ä¾‹é‚£æ¨£ï¼Œè‡ªå·±å¯«å€‹<code class="language-plaintext highlighter-rouge">main.py</code>ä¾†å»æª¢æŸ¥ã€‚</p>

<h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™</h2>

<ul>
  <li>
    <p><a href="https://medium.com/ai-blog-tw/%E7%B5%A6ml-engineer%E7%9A%84mlops%E7%B0%A1%E8%BF%B0-%E6%8C%81%E7%BA%8C%E9%96%8B%E7%99%BC%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92service%E7%9A%84%E9%AB%98%E6%95%88%E7%90%86%E5%BF%B5-8bd552876299">çµ¦ML Engineerçš„MLOpsç°¡è¿°: æŒçºŒé–‹ç™¼æ©Ÿå™¨å­¸ç¿’Serviceçš„é«˜æ•ˆç†å¿µ</a></p>
  </li>
  <li>
    <p><a href="https://cloud.google.com/architecture/mlops-continuous-delivery-and-automation-pipelines-in-machine-learning#devops_versus_mlops">MLOps: Continuous delivery and automation pipelines in machine learning</a></p>
  </li>
</ul>]]></content><author><name>Your Name</name></author><category term="Tool" /><summary type="html"><![CDATA[éš¨è‘—æ©Ÿå™¨å­¸ç¿’çš„èˆˆèµ·ï¼Œæœ‰è¶Šä¾†è¶Šå¤šäººå˜—è©¦å¼•å…¥MLOpsåœ¨ç³»çµ±ç•¶ä¸­ï¼Œé€™ç¯‡æ–‡ç« ç°¡å–®ä»‹ç´¹ä¸€ä¸‹MLflowçš„ä½¿ç”¨å¿ƒå¾—ã€‚]]></summary></entry><entry><title type="html">Learning Hierarchy-Aware Knowledge Graph Embeddings for Link Prediction</title><link href="https://wjohn1483.github.io/#%20the%20base%20hostname%20&%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/05/14/Learning-Hierarchy-Aware-Knowledge-Graph-Embeddings-for-Link-Prediction/" rel="alternate" type="text/html" title="Learning Hierarchy-Aware Knowledge Graph Embeddings for Link Prediction" /><published>2022-05-14T00:00:00+00:00</published><updated>2022-05-14T00:00:00+00:00</updated><id>https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/05/14/Learning-Hierarchy-Aware-Knowledge-Graph-Embeddings-for-Link-Prediction</id><content type="html" xml:base="https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/05/14/Learning-Hierarchy-Aware-Knowledge-Graph-Embeddings-for-Link-Prediction/"><![CDATA[<p>ç°¡å–®è¨˜éŒ„ä¸€ä¸‹çœ‹å®Œé€™ç¯‡paperçš„ç­†è¨˜ã€‚</p>

<!--more-->

<p><a href="https://arxiv.org/abs/1911.09419">é€™ç¯‡paper</a>æ˜¯AAAI 2020ä¸­è¢«ç™¼è¡¨çš„paperï¼Œç›¸è¼ƒæ–¼å…¶ä»–knowledge graphçš„paperï¼Œé€™ç¯‡paperæŠŠæ‰€æœ‰çš„entityéƒ½æ”¾é€²æ¥µåº§æ¨™ç•¶ä¸­ï¼Œå¸Œæœ›è®“æ¨¡å‹å­¸ç¿’åˆ°è¶Šå…§å±¤çš„entityæ˜¯éšå±¤ä¸­æ¯”è¼ƒé«˜çš„ï¼Œè¶Šå¤–å±¤çš„eneityæ˜¯éšå±¤ä¸­æ¯”è¼ƒä½çš„ã€‚</p>

<h2 id="hierarchy-aware-knowledge-graph-embedding-hake">Hierarchy-Aware Knowledge Graph Embedding (HAKE)</h2>

<p><img src="./model_illustration.png" alt="Model Illustration" /></p>

<h3 id="annotation">Annotation</h3>

<p>åœ¨è¼¸å…¥çµ¦æ¨¡å‹çš„è³‡æ–™ç•¶ä¸­ï¼Œä¸»è¦æœƒæ˜¯å„å€‹entityä¹‹é–“çš„relationï¼Œå¯«ä½œ<code class="language-plaintext highlighter-rouge">(head, relation, tail)</code>ï¼ŒæŒ‡å¾—æ˜¯èªª<code class="language-plaintext highlighter-rouge">head</code>å’Œ<code class="language-plaintext highlighter-rouge">tail</code>ä¹‹é–“æœ‰<code class="language-plaintext highlighter-rouge">relation</code>ï¼Œè€Œ<code class="language-plaintext highlighter-rouge">head</code>æ˜¯æ¯”è¼ƒä¸Šå±¤çš„ï¼Œä»¥ä¸Šé¢åœ–ç‰‡ä¸­çš„ä¾‹å­ä¾†èªªï¼Œå¯èƒ½çš„è³‡æ–™æœƒæ˜¯</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">(Device,</span><span class="w"> </span><span class="err">has_function,</span><span class="w"> </span><span class="err">Source)</span><span class="w">
</span><span class="err">(Device,</span><span class="w"> </span><span class="err">has_function,</span><span class="w"> </span><span class="err">Support)</span><span class="w">
</span><span class="err">(Source,</span><span class="w"> </span><span class="err">has_object,</span><span class="w"> </span><span class="err">Lamp)</span><span class="w">
</span><span class="err">(Source,</span><span class="w"> </span><span class="err">has_object,</span><span class="w"> </span><span class="err">Light)</span><span class="w">
</span><span class="err">...</span><span class="w">
</span></code></pre></div></div>

<p>åœ¨paperè£¡é¢æˆ‘å€‘æœƒçµ¦æ¯ä¸€å€‹<code class="language-plaintext highlighter-rouge">head</code>ã€<code class="language-plaintext highlighter-rouge">relation</code>å’Œ<code class="language-plaintext highlighter-rouge">tail</code>å„ä¸€å€‹embeddingï¼Œåˆ†åˆ¥å¯«ä½œ$\mathbf{h}$ã€$\mathbf{r}$å’Œ$\mathbf{t}$ï¼Œå…¶ä¸­å› ç‚ºä½œè€…æƒ³è¦å°‡embeddingå­˜åœ¨åœ¨æ¥µåº§æ¨™ç•¶ä¸­ï¼Œæ‰€ä»¥æ¯ä¸€å€‹embeddingéƒ½æœƒå­˜åœ¨æœ‰moduluså’Œphaseçš„é€™å…©å€‹éƒ¨åˆ†ï¼Œä»¥headçš„embeddingç‚ºä¾‹ï¼Œä»–å€‘åˆ†åˆ¥æœƒè¢«å¯«ä½œ$\mathbf{h}_m$ã€$\mathbf{h}_p$ã€‚</p>

<h3 id="modulus-distance">Modulus Distance</h3>

<p>åœ¨è¨ˆç®—å…©å€‹embeddingç›¸ä¼¼æ€§çš„æ™‚å€™ï¼ŒæœƒæŠŠmoduluså’Œphaseé€™å…©å€‹éƒ¨åˆ†æ‹†é–‹ä¾†çœ‹ï¼Œæˆ‘å€‘æœƒå¸Œæœ›$\mathbf{h}_m$åœ¨ç¶“érelationçš„è½‰æ›ä»¥å¾Œï¼Œè¶Šåƒ$\mathbf{t}_m$è¶Šå¥½ï¼Œäº¦å³</p>

\[\mathbf{h}_m \circ \mathbf{r}_m = \mathbf{t}_m\]

<p>è€Œè·é›¢çš„éƒ¨åˆ†å°±æ˜¯çœ‹å¯¦éš›ä¸Šè·Ÿé æœŸçš„è½å·®æœ‰å¤šå°‘</p>

\[d_{r,m}(\mathbf{h}_m, \mathbf{t}_m)=\left\| \mathbf{h}_m\circ\mathbf{r}_m-\mathbf{t}_m\right\|_2\]

<p>å…¶ä¸­å€¼å¾—ä¸€æçš„æ˜¯ï¼Œé›–ç„¶embeddingæœ¬èº«å¯ä»¥æœ‰è² å€¼ï¼Œä½†$\mathbf{r}_m$çš„éƒ¨åˆ†æœƒé™åˆ¶è£¡é¢æ‰€æœ‰çš„å€¼éƒ½å¿…é ˆè¦å¤§æ–¼é›¶ï¼ŒåŸå› æ˜¯å› ç‚ºæˆ‘å€‘æƒ³è¦éšå±¤æ¯”è¼ƒé«˜çš„entityåœ¨æ¥è¿‘åŸé»çš„ä½ç½®ï¼Œç”±æ–¼$[\mathbf{r}_m]_i&gt;0$çš„ç‰¹æ€§ï¼Œæ¨¡å‹æ¼¸æ¼¸åœ°å°±æœƒå°‡éšå±¤ä½çš„embeddingå¾€å¤–æ¨äº†ã€‚</p>

<h3 id="phase-distance">Phase Distance</h3>

<p>åœ¨phaseçš„éƒ¨åˆ†è·Ÿmoduluså·®ä¸å¤šï¼Œæˆ‘å€‘å¸Œæœ›$\mathbf{h}_p$åœ¨ç¶“érelationçš„è½‰æ›ä»¥å¾Œï¼Œè¶Šåƒ$\mathbf{t}_p$è¶Šå¥½</p>

\[(\mathbf{h}_p+\mathbf{r}_p)\mod 2\pi=\mathbf{t}_p,\ where\ \mathbf{h}_p,\mathbf{r}_p,\mathbf{t}_p\in[0,2\pi)^k\]

<p>è·é›¢ä¸Šä¹Ÿæ˜¯çœ‹å…©è€…ç›¸å·®å¤šå°‘</p>

\[d_{r,p}(\mathbf{h}_p, \mathbf{t}_p)=\left\| \sin((\mathbf{h}_p+\mathbf{r}_p-\mathbf{t}_p)/2)\right\|_1\]

<h3 id="loss-function">Loss Function</h3>

<p>ä¸Šé¢åˆ†åˆ¥å®šç¾©äº†modulus distanceå’Œphase distanceï¼Œå…©å€‹entityå¯¦éš›çš„è·é›¢ä¾¿å¯å®šç¾©æˆ</p>

\[d_r(\mathbf{h},\mathbf{t})=d_{r,m}(\mathbf{h}_m,\mathbf{t}_m)+\lambda d_{r,p}(\mathbf{h}_p,\mathbf{t}_p)\]

<p>å…¶ä¸­çš„$\lambda$æ˜¯ç”±modelè‡ªè¡Œå­¸å‡ºçš„åƒæ•¸ï¼ˆ$\lambda\in\mathbb{R}$ï¼‰ï¼Œè€Œloss functionä¾¿æ˜¯ç”¨self-adversarialçš„lossï¼Œå¸Œæœ›positive sampleçš„è·é›¢è¦å°æ–¼$\gamma$ï¼Œnegative sampleçš„è·é›¢è¦å¤§æ–¼$\gamma$</p>

\[L=-\log\sigma(\gamma-d_r(\mathbf{h},\mathbf{t}))-\sum\limits^{n}\limits_{i=1}p(h'_i,r,t'_i)\log\sigma(d_r(\mathbf{h}'_i,\mathbf{t}'_i)-\gamma)\]

\[p(h'_j,r,y'_j\vert\left\{(h_i,r_i,t_i)\right\})=\frac{\exp\alpha f_r(\mathbf{h}'_j,\mathbf{t}'_j)}{\sum_i\exp\alpha f_r(\mathbf{h}'_i,\mathbf{t}'_i)},\ where\ \alpha\ is\ temperature\]

\[f_r(\mathbf{h},\mathbf{t})=-d_r(\mathbf{h},\mathbf{t})=-d_{r,m}(\mathbf{h},\mathbf{t})-\lambda d_{r,p}(\mathbf{h},\mathbf{t})\]

<h2 id="experiments">Experiments</h2>

<p>ä½œè€…æŠŠé€™å€‹HAKEæ¨¡å‹ä½¿ç”¨åœ¨åº•ä¸‹ä¸‰å€‹datasetä¸Šï¼Œå®ƒå€‘çš„ä¸€äº›æ•¸æ“šæ”¾åœ¨åº•ä¸‹çš„è¡¨æ ¼ä¸­ã€‚</p>

<p><img src="./datasets.png" alt="Datasets" /></p>

<p><img src="./results.png" alt="Results" /></p>

<p>ä¸Šé¢æ˜¯èˆ‡å…¶ä»–æ¨¡å‹åœ¨é€™ä¸‰å€‹datasetä¸Šçš„æ¯”è¼ƒï¼Œå¯ä»¥çœ‹åˆ°HAKEçš„è¡¨ç¾ä¸ä¿—ã€‚</p>]]></content><author><name>Your Name</name></author><category term="Paper" /><category term="Graph-Model" /><summary type="html"><![CDATA[ç°¡å–®è¨˜éŒ„ä¸€ä¸‹çœ‹å®Œé€™ç¯‡paperçš„ç­†è¨˜ã€‚]]></summary></entry><entry><title type="html">Supersetä»‹ç´¹</title><link href="https://wjohn1483.github.io/#%20the%20base%20hostname%20&%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/05/02/superset-introduction/" rel="alternate" type="text/html" title="Supersetä»‹ç´¹" /><published>2022-05-02T00:00:00+00:00</published><updated>2022-05-02T00:00:00+00:00</updated><id>https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/05/02/superset-introduction</id><content type="html" xml:base="https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/05/02/superset-introduction/"><![CDATA[<p>é€™ç¯‡æ–‡ç« ç°¡å–®è¨˜éŒ„ä¸€ä¸‹å¦‚ä½•å®‰è£supersetä¸¦å¾Google Sheetså’ŒCSVç•¶ä¸­åŒ¯å…¥è³‡æ–™åšæˆdashboardã€‚</p>

<!--more-->

<h2 id="supersetç°¡ä»‹">Supersetç°¡ä»‹</h2>

<p>Supersetæ˜¯å€‹æœ€æ—©ç”±Airbnbé–‹ç™¼ï¼Œå¾Œä¾†é–‹æºåˆ°Apacheçš„businese intelligenceå·¥å…·ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥æ–¹ä¾¿åœ°è¦–è¦ºåŒ–è³‡æ–™åº«è£¡é¢çš„è³‡æ–™ï¼Œè€Œé€™é‚Šçš„è³‡æ–™åº«é™¤äº†å¸¸è¦‹çš„PostgreSQLã€Hiveä»¥å¤–ï¼Œé‚„æ”¯æ´å¾Google Sheetså’Œä½¿ç”¨è€…ä¸Šå‚³çš„CSVä¾†ç•¶ä½œè³‡æ–™çš„æºé ­ã€‚</p>

<h2 id="å®‰è£superset">å®‰è£Superset</h2>

<p>é€™é‚Šæ”¾ä¸Šæˆ‘å®‰è£æ™‚ä½¿ç”¨çš„æŒ‡ä»¤ï¼Œå…¶ä»–çš„å®‰è£æ–¹æ³•æˆ–è©³ç´°çš„ä»‹ç´¹å¯ä»¥åƒè€ƒ<a href="https://superset.apache.org/docs/installation/installing-superset-from-scratch">å®˜æ–¹çš„å®‰è£æ–‡ä»¶</a>ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>yum <span class="nb">install</span> <span class="nt">-y</span> gcc gcc-c++ libffi-devel python-devel python-pip python-wheel openssl-devel cyrus-sasl-devel openldap-devel bzip2-devel xz-devel
pip3 <span class="nb">install</span> <span class="nt">--upgrade</span> pip
pip3 <span class="nb">install </span>apache-superset <span class="nv">MarkupSafe</span><span class="o">==</span>2.0.1
<span class="c"># Recompile python if is shows python cannot import bz2</span>

<span class="nb">export </span><span class="nv">FLASK_APP</span><span class="o">=</span>superset
superset db upgrade

<span class="c"># Create default roles and permissions</span>
superset init

<span class="c"># Create an admin user in your metadata database (use `admin` as username to be able to load the examples)</span>
superset fab create-admin

<span class="c"># Load some data to play with</span>
superset load_examples

<span class="c"># To start a development web server on port 8088, use -p to bind to another port</span>
superset run <span class="nt">-p</span> 8088 <span class="nt">--with-threads</span> <span class="nt">--reload</span> <span class="nt">--debugger</span>
</code></pre></div></div>

<p>åœ¨ä¸Šé¢çš„æŒ‡ä»¤ä¸­ï¼Œæˆ‘å€‘æœ‰å»ºç«‹äº†ä¸€å€‹adminå¸³è™Ÿï¼Œå…¶å¸³è™Ÿå¯†ç¢¼éƒ½æ˜¯<code class="language-plaintext highlighter-rouge">admin</code>ï¼Œä¸¦åœ¨æœ€å¾Œä¸€è¡Œçš„æŒ‡ä»¤å•Ÿå‹•äº†supersetï¼Œé€™æ™‚ç†è«–ä¸Šé€£åˆ°<code class="language-plaintext highlighter-rouge">localhost:8088</code>å°±èƒ½çœ‹åˆ°supersetçš„UIäº†ã€‚</p>

<h2 id="è£½ä½œdashboardæµç¨‹">è£½ä½œDashboardæµç¨‹</h2>

<p>åœ¨supersetè£¡é¢è¦è£½ä½œæœ€å¾Œçš„dashboardå‰æœ‰å¹¾å€‹æ­¥é©Ÿéœ€è¦å…ˆåŸ·è¡Œï¼š</p>

<ol>
  <li>
    <p>å»ºç«‹Databaseï¼šèˆ‡databaseå»ºç«‹é€£ç·šï¼Œè®“supersetèƒ½å¾databaseè£¡é¢æ’ˆå–è³‡æ–™å‡ºä¾†ã€‚</p>
  </li>
  <li>
    <p>å»ºç«‹Datasetï¼šå¾databaseè£¡é¢å¼•å…¥tableï¼Œåœ¨databaseè£¡é¢å¯èƒ½æœ‰åƒåƒè¬è¬å€‹tableï¼Œé€™é‚Šæˆ‘å€‘éœ€è¦å‘Šè¨´supersetæˆ‘å€‘æœ‰èˆˆè¶£çš„tableæ˜¯å“ªäº›ï¼ŒåªæŠŠæœ‰èˆˆè¶£çš„table schemaå¼•å…¥åˆ°supersetè£¡é¢ã€‚</p>
  </li>
  <li>
    <p>è£½ä½œchartï¼šå¼•å…¥äº†tableä»¥å¾Œï¼Œå°±èƒ½å¯«SQLæˆ–æ˜¯ç”¨é å…ˆå®šç¾©å¥½çš„metricï¼ˆ$SUM(\star)$ã€$COUNT(\star)$ï¼‰ä¾†è¦–è¦ºåŒ–tableçš„è³‡è¨Šã€‚</p>
  </li>
  <li>
    <p>è£½ä½œdashboardï¼šæŠŠå‰ä¸€å€‹æ­¥é©Ÿè£½ä½œçš„chartçš„å‘ˆç¾åœ¨ä¸€å€‹dashboardä¸­ï¼Œæ–¹ä¾¿ä¸€æ¬¡ç€è¦½å¤šå€‹tableè¦–è¦ºåŒ–çš„çµæœã€‚</p>
  </li>
</ol>

<h2 id="å»ºç«‹database">å»ºç«‹Database</h2>

<p>åº•ä¸‹ä»‹ç´¹å¦‚ä½•ä½¿ç”¨é€£çµGoogle Sheetså’ŒPostgreSQLé€™å…©å€‹databaseï¼Œå¦‚æœæƒ³è¦é€£çµå…¶ä»–databaseçš„è©±ï¼Œå¯ä»¥åƒè€ƒ<a href="https://superset.apache.org/docs/databases/installing-database-drivers">å®˜æ–¹æ–‡ä»¶</a>ã€‚ç”±æ–¼supersetä¸»è¦æ˜¯ç”±pythonæ‰€ç·¨å¯«çš„ï¼Œç‚ºäº†è¦èƒ½è·Ÿdatabaseåšé€£ç·šï¼Œæˆ‘å€‘éœ€è¦å®‰è£ç›¸é—œdatabaseçš„python APIï¼Œåœ¨æ–‡ä»¶è£¡é¢æœ‰å»ºè­°è¦å®‰è£å“ªäº›å¥—ä»¶ã€‚</p>

<h3 id="google-sheets">Google Sheets</h3>

<h4 id="å®‰è£driver">å®‰è£driver</h4>

<p>å› ç‚ºåœ¨ å‰é¢æ˜¯é€é<code class="language-plaintext highlighter-rouge">pip3 install</code>ä¾†å®‰è£supersetçš„ï¼Œæ‰€ä»¥åœ¨é€™é‚Šä¹Ÿåªéœ€è¦ç°¡å–®çš„å®‰è£pip packageå°±èƒ½è®“supersetä½¿ç”¨äº†ï¼Œä¸éæœ‰å¯èƒ½æœƒéœ€è¦é‡æ–°å•Ÿå‹•supersetä¾†è®“å®ƒåƒåˆ°æœ€æ–°çš„APIã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip3 <span class="nb">install </span>shillelagh
</code></pre></div></div>

<h4 id="å¼•å…¥database">å¼•å…¥database</h4>

<p>åœ¨å®‰è£å¥½Google Sheets driverä»¥å¾Œï¼Œåœ¨supersetçš„UIä¸Šé¢é»é¸<code class="language-plaintext highlighter-rouge">Data&gt;Databases</code>ï¼Œåœ¨å³é‚Šå¯ä»¥çœ‹åˆ°æ–°å¢Databaseçš„æŒ‰éˆ•ï¼Œé»ä¸‹å»ä»¥å¾Œç†è«–ä¸Šå°±èƒ½çœ‹åˆ°<code class="language-plaintext highlighter-rouge">Google Sheets</code>çš„é¸é …äº†ã€‚</p>

<p><img src="./supported_databases_google_sheets.png" alt="Supported Databases - Google Sheets" /></p>

<p>åœ¨ä¸‹ä¸€å€‹ç•«é¢ç•¶ä¸­åªè¦å¡«ä¸Šç›¸å°æ‡‰çš„åç¨±å’Œç¶²å€å°±èƒ½é †åˆ©å»ºç«‹äº†ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯Google Sheetsçš„æ¬Šé™å¿…é ˆè¦è¨­å®šæˆæ‰€æœ‰äººéƒ½èƒ½è§€çœ‹æ‰èƒ½å¼•å…¥ï¼Œå¦‚æœæƒ³è¦è®“ç§äººçš„Google Sheetsèƒ½è¢«supersetè®€å–çš„è©±ï¼Œå¯ä»¥åƒè€ƒ<a href="https://docs.preset.io/docs/google-sheets-private-connection">é€™ç¯‡æ–‡ç« </a>ï¼Œå¦å¤–Google Sheetsè£¡é¢æ¯ä¸€å€‹ä¸åŒçš„tabéƒ½éœ€è¦æ‰‹å‹•æ–°å¢é€²ä¾†ï¼Œå‡å¦‚èªªæˆ‘å€‘æƒ³è¦å¼•å…¥é€™å€‹sheetsè£¡é¢çš„<code class="language-plaintext highlighter-rouge">Simple sheet</code>ã€<code class="language-plaintext highlighter-rouge">2 header sheet</code>å’Œ<code class="language-plaintext highlighter-rouge">birth_names</code>çš„è©±ï¼Œå°±æœƒéœ€è¦å¡«å¯«ä»¥ä¸‹çš„è¨­å®šã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Name: simple sheet
URL: https://docs.google.com/spreadsheets/d/1_rN3lm0R_bU3NemO0s9pbFkY5LQPcuy1pscv8ZXPtg8/edit#gid<span class="o">=</span>0

Name: 2 header sheet
URL: https://docs.google.com/spreadsheets/d/1_rN3lm0R_bU3NemO0s9pbFkY5LQPcuy1pscv8ZXPtg8/edit#gid<span class="o">=</span>1077884006

Name: birth names
URL: https://docs.google.com/spreadsheets/d/1_rN3lm0R_bU3NemO0s9pbFkY5LQPcuy1pscv8ZXPtg8/edit#gid<span class="o">=</span>174770703
</code></pre></div></div>

<h3 id="postgresql">PostgreSQL</h3>

<h4 id="å®‰è£postgresql">å®‰è£PostgreSQL</h4>

<p>å®‰è£PostgreSQLçš„æ–¹å¼åœ¨ä¸åŒçš„OSä¸Šä¸å¤ªä¸€æ¨£ï¼Œé€™é‚Šè²¼ä¸Šæˆ‘å®‰è£æ™‚ä½¿ç”¨çš„æŒ‡ä»¤ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>yum <span class="nb">install</span> <span class="nt">-y</span> https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm
<span class="nb">sudo </span>yum <span class="nb">install</span> <span class="nt">-y</span> postgresql14-server
<span class="nb">sudo</span> /usr/pgsql-14/bin/postgresql-14-setup initdb
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>postgresql-14
<span class="nb">sudo </span>systemctl start postgresql-14
</code></pre></div></div>

<p>å®‰è£å¥½PostgreSQLä»¥å¾Œï¼Œæˆ‘å€‘éœ€è¦åœ¨å…¶ä¸­å»ºç«‹ä½¿ç”¨è€…å¸³è™Ÿï¼Œå¯ä»¥åƒè€ƒåº•ä¸‹çš„æŒ‡ä»¤ï¼Œè¨˜å¾—å°‡<code class="language-plaintext highlighter-rouge">USER_NAME</code>æ›¿æ›æˆè‡ªå·±çš„å¸³è™Ÿåç¨±ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo</span> <span class="nt">-i</span> <span class="nt">-u</span> postgres
createuser USER_NAME
createdb USER_NAME
</code></pre></div></div>

<p>å¦‚æœé †åˆ©çš„è©±ï¼Œç†è«–ä¸Šåœ¨è‡ªå·±å¸³è™Ÿåº•ä¸‹åŸ·è¡Œ<code class="language-plaintext highlighter-rouge">psql</code>æ‡‰è©²å°±èƒ½é€²å…¥PostgreSQLçš„ä»‹é¢äº†ï¼Œé€™æ™‚æˆ‘å€‘éœ€è¦å¹«é€™å€‹å¸³è™Ÿè¨­å®šä¸€å€‹å¯†ç¢¼æ–¹ä¾¿supersetä¾†ç™»å…¥ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># In psql command line</span>
alter user USER_NAME password <span class="s1">'PASSWORD'</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="å®‰è£driver-1">å®‰è£driver</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip3 <span class="nb">install </span>psycopg2-binary
</code></pre></div></div>

<h4 id="å¼•å…¥database-1">å¼•å…¥database</h4>

<p>å®‰è£å¥½driverä»¥å¾Œï¼Œåœ¨æŒ‰ä¸‹æ–°å¢databaseçš„æŒ‰éˆ•æ™‚ï¼Œæ‡‰è©²å°±èƒ½çœ‹åˆ°PostgreSQLçš„é¸é …äº†ï¼Œé€™é‚Šè²¼ä¸Šé è¨­çš„è¨­å®šï¼Œç†è«–ä¸ŠæŠŠ<code class="language-plaintext highlighter-rouge">USER_NAME</code>ã€<code class="language-plaintext highlighter-rouge">PASSWORD</code>æ›¿æ›æˆè‡ªè¡Œè¨­å®šçš„å€¼å¾ŒæŒ‰ä¸‹connectå°±å¯ä»¥äº†ã€‚</p>

<p><img class="image image--xl" src="./postgresql_database_settings.png" /></p>

<p>å¦‚æœå¸Œæœ›è®“supersetæ”¯æ´CSVä¸Šå‚³çš„åŠŸèƒ½ï¼Œéœ€è¦åœ¨<code class="language-plaintext highlighter-rouge">ADVANCED</code>çš„è¨­å®šä¸­çš„<code class="language-plaintext highlighter-rouge">Security</code>è£¡é¢å‹¾é¸<code class="language-plaintext highlighter-rouge">Allow data upload</code>çš„é¸é …ï¼Œä¸Šå‚³çš„CSVæœƒåœ¨PostgreSQLè£¡é¢å»ºç«‹ä¸€å¼µæ–°çš„tableã€‚</p>

<h2 id="å»ºç«‹dataset">å»ºç«‹Dataset</h2>

<p>åœ¨æˆåŠŸå¼•å…¥databaseä»¥å¾Œï¼Œåœ¨<code class="language-plaintext highlighter-rouge">Data&gt;Datasets</code>è£¡é¢æŒ‰ä¸‹æ–°å¢Datasetçš„æŒ‰éˆ•ï¼Œé¸æ“‡å¥½databaseå°±èƒ½çœ‹åˆ°å‰é¢å¼•å…¥çš„databaseè£¡é¢çš„tableå€‘äº†ï¼Œé»é¸<code class="language-plaintext highlighter-rouge">ADD</code>ä»¥å¾Œå°±èƒ½åœ¨chartè£¡é¢è®€å–é€™äº›tableçš„è³‡æ–™ã€‚</p>

<p><img class="image image--xl" src="./add_dataset.png" /></p>

<h2 id="è£½ä½œchart">è£½ä½œChart</h2>

<p>æˆåŠŸå¼•å…¥datasetä»¥å¾Œï¼Œåœ¨create chartçš„éƒ¨åˆ†å°±èƒ½æ‰¾åˆ°å…ˆå‰å¼•å…¥çš„datasetäº†ï¼Œæ¥è‘—å°±èƒ½æ ¹æ“šæƒ³çœ‹çš„è³‡è¨Šä¾†åšå‡ºæ¼‚äº®çš„åœ–è¡¨ã€‚</p>

<p><img src="./create_new_chart.png" alt="Create New Chart" /></p>

<p><img src="./chart_settings.png" alt="Chart Settings" /></p>

<h2 id="è£½ä½œdashboard">è£½ä½œDashboard</h2>

<p>åœ¨æŠŠtableçš„è³‡è¨Šè¦–è¦ºåŒ–æˆchartä»¥å¾Œï¼Œå¦‚æœæƒ³è¦å°‡å¤šå€‹charté¡¯ç¤ºåœ¨åŒä¸€å€‹ç•«é¢å¯ä»¥ä½¿ç”¨dashboardï¼Œåœ¨å»ºç«‹dashboardçš„ç•«é¢è£¡é¢å¯ä»¥ç”¨æ‹–æ›³çš„æ–¹å¼ä¾†æŠŠæƒ³è¦é¡¯ç¤ºçš„chartæ”¾é€²ä¾†ã€‚</p>

<p><img src="./dashboard_settings.png" alt="Dashboard Settings" /></p>

<p>æœ€å¾ŒæŒ‰ä¸‹Saveå°±å¤§åŠŸå‘Šæˆäº†ã€‚</p>

<p><img src="./dashboard_demo.png" alt="Dashboard Demo" /></p>]]></content><author><name>Your Name</name></author><category term="Tool" /><summary type="html"><![CDATA[é€™ç¯‡æ–‡ç« ç°¡å–®è¨˜éŒ„ä¸€ä¸‹å¦‚ä½•å®‰è£supersetä¸¦å¾Google Sheetså’ŒCSVç•¶ä¸­åŒ¯å…¥è³‡æ–™åšæˆdashboardã€‚]]></summary></entry><entry><title type="html">Airflowä»‹ç´¹</title><link href="https://wjohn1483.github.io/#%20the%20base%20hostname%20&%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/02/26/airflow-introduction/" rel="alternate" type="text/html" title="Airflowä»‹ç´¹" /><published>2022-02-26T00:00:00+00:00</published><updated>2022-02-26T00:00:00+00:00</updated><id>https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/02/26/airflow-introduction</id><content type="html" xml:base="https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2022/02/26/airflow-introduction/"><![CDATA[<p>é€™ç¯‡æ–‡ç« ç´€éŒ„ä¸€ä¸‹å˜—è©¦ä½¿ç”¨Airflowçš„ç¶“æ­·ã€‚</p>

<!--more-->

<p>ä¹‹å‰åœ¨è½ä¸€äº›æŠ€è¡“åˆ†äº«çš„æ™‚å€™ï¼Œæœ‰è½åˆ°åˆ¥äººä½¿ç”¨Airflowä¾†ä½œç‚ºä»–å€‘çš„æ’ç¨‹ç³»çµ±ï¼Œå‰›å¥½åœ¨ç¶²è·¯ä¸Šä¹Ÿæœ‰çœ‹åˆ°åˆ¥äºº<a href="https://leemeng.tw/a-story-about-airflow-and-data-engineering-using-how-to-use-python-to-catch-up-with-latest-comics-as-an-example.html">ä½¿ç”¨Airflowä¾†è¿½æ¼«ç•«é€£è¼‰</a>ï¼Œæƒ³èªªæˆ‘ä¹Ÿä¾†åšä¸€å€‹ç°¡å–®çš„æ¯å¤©ç™»å…¥é ˜çå‹µçš„ç¨‹å¼ä¾†å­¸ç¿’Airflowæ€éº¼ä½¿ç”¨ï¼Œåº•ä¸‹ç´€éŒ„ä¸€ä¸‹è£½ä½œçš„éç¨‹ã€‚</p>

<h2 id="å®‰è£airflow">å®‰è£Airflow</h2>

<p><a href="https://airflow.apache.org/">Airflow</a>æ˜¯ç”±Airbnbé–‹ç™¼çš„æ’ç¨‹ç³»çµ±ï¼Œä¸»è¦æ˜¯ç”±pythonç·¨å¯«ï¼Œå®‰è£èµ·ä¾†ä¹Ÿç›¸ç•¶åœ°æ–¹ä¾¿ï¼Œåªéœ€è¦åŸ·è¡Œåº•ä¸‹çš„æŒ‡ä»¤å°±è¡Œã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip3 <span class="nb">install</span> <span class="s2">"apache-airflow[crypto, slack]"</span>
</code></pre></div></div>

<h3 id="åˆå§‹åŒ–database">åˆå§‹åŒ–database</h3>

<p>åœ¨å®‰è£å®Œæˆä»¥å¾Œï¼Œæœƒéœ€è¦å…ˆåˆå§‹åŒ–airflowçš„databaseï¼Œé€™å€‹databaseæœƒç”¨ä¾†å„²å­˜ä»»å‹™åŸ·è¡Œçš„è¨­å®šå’Œlogã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># export AIRFLOW_HOME=/path/you/want</span>
airflow db init
</code></pre></div></div>

<p>é è¨­çš„è·¯å¾‘æœƒæ”¾åœ¨<code class="language-plaintext highlighter-rouge">~/airflow</code>ï¼Œä½ ä¹Ÿå¯ä»¥è—‰ç”±<code class="language-plaintext highlighter-rouge">export AIRFLOW_HOME</code>ä¾†é¸æ“‡è‡ªå·±å–œæ­¡çš„ä½ç½®ã€‚</p>

<h3 id="é–‹å•Ÿweb-server">é–‹å•Ÿweb server</h3>

<p>æ¥ä¸‹ä¾†å°±å¯ä»¥æº–å‚™å•Ÿå‹•airflowäº†ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨åº•ä¸‹çš„æŒ‡ä»¤é–‹å•Ÿweb serverï¼Œä¸¦è¨­å®športç‚º8080ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>airflow webserver <span class="nt">-p</span> 8080
</code></pre></div></div>

<p>é€™æ™‚å°±å¯ä»¥é€£å»<code class="language-plaintext highlighter-rouge">localhost:8080</code>ä¾†çœ‹åˆ°airflowçš„ä½¿ç”¨è€…ä»‹é¢äº†ï¼Œä½†é€²å»çš„æ™‚å€™æœƒç™¼ç¾è¦å¸³è™Ÿå¯†ç¢¼æ‰èƒ½ç™»å…¥ï¼Œæˆ‘å€‘å¯ä»¥é€éä¸‹é¢çš„æŒ‡ä»¤ä¾†å‰µå»ºä¸€å€‹æ¬Šé™ç‚ºadminçš„å¸³æˆ¶ï¼Œå…¶å¸³è™Ÿå¯†ç¢¼éƒ½æ˜¯<code class="language-plaintext highlighter-rouge">admin</code>ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>airflow <span class="nb">users </span>create <span class="nt">--role</span> Admin <span class="nt">--username</span> admin <span class="nt">--email</span> admin <span class="nt">--firstname</span> admin <span class="nt">--lastname</span> admin <span class="nt">--password</span> admin
</code></pre></div></div>

<p>ç†è«–ä¸Šåœ¨é€™å€‹æ­¥é©Ÿåšå®Œä»¥å¾Œå°±èƒ½é †åˆ©åœ°çœ‹åˆ°é¡ä¼¼æ–¼åº•ä¸‹çš„ç•«é¢äº†ã€‚</p>

<p><img src="./airflow_ui.png" alt="Airflow UI" /></p>

<h3 id="é–‹å•Ÿscheduler">é–‹å•Ÿscheduler</h3>

<p>é›–èªªUIå·²ç¶“æ‰“å¾—é–‹äº†ï¼Œä½†æœƒç™¼ç¾ä¸Šé¢çš„ä»»å‹™éƒ½æ²’è¾¦æ³•åŸ·è¡Œï¼ŒåŸå› æ˜¯å› ç‚ºå¯¦éš›ä¸Šæ’ç¨‹é€™äº›ä»»å‹™çš„æ˜¯schedulerï¼Œè€Œweb serverå°±çœŸçš„åªæ˜¯ä¸€å€‹UIè®“ä½¿ç”¨è€…æ–¹ä¾¿ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘å€‘é‚„éœ€è¦åŸ·è¡Œåº•ä¸‹çš„æŒ‡ä»¤æ‰èƒ½å•Ÿå‹•ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>airflow scheduler
</code></pre></div></div>

<p>schedulerå’Œweb serverçš„é—œä¿‚å¯ä»¥åƒè€ƒ<a href="https://airflow.apache.org/docs/apache-airflow/stable/concepts/overview.html">airflowå®˜æ–¹æ–‡ä»¶</a>è£¡é¢çš„æ¶æ§‹åœ–ã€‚</p>

<p><img src="https://airflow.apache.org/docs/apache-airflow/stable/_images/arch-diag-basic.png" alt="Airflow Architecture" /></p>

<h2 id="å»ºç«‹å±¬æ–¼è‡ªå·±çš„ä»»å‹™">å»ºç«‹å±¬æ–¼è‡ªå·±çš„ä»»å‹™</h2>

<p>å‰é¢æœ‰æåˆ°airflowä¸»è¦æ˜¯ç”±pythonä¾†ç·¨å¯«çš„ï¼Œç•¶æˆ‘å€‘è¦åŠ å…¥ä¸€å€‹æ–°çš„ä»»å‹™æ™‚ï¼Œæˆ‘å€‘ä¹Ÿæ˜¯å¯«ä¸€å€‹pythonçš„scriptï¼Œä¸¦æ”¾å…¥<code class="language-plaintext highlighter-rouge">${AIRFLOW_HOME}/dags/</code>ï¼ˆé è¨­æ˜¯<code class="language-plaintext highlighter-rouge">~/airflow/dags/</code>ï¼‰é€™å€‹è·¯å¾‘åº•ä¸‹ï¼Œairflowå°±æœƒè‡ªå‹•æŠ“å–ä½ å¯«çš„scriptï¼Œåœ¨UIä¸Šé¢é¡¯ç¤ºå‡ºä¾†ã€‚</p>

<h3 id="airflow-python-script">Airflow Python Script</h3>

<p>ä¸€å€‹ç°¡å–®çš„ä»»å‹™å¯ä»¥åƒè€ƒåº•ä¸‹çš„ç¨‹å¼ç¢¼ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="kn">from</span> <span class="nn">airflow</span> <span class="kn">import</span> <span class="n">DAG</span>
<span class="kn">from</span> <span class="nn">airflow.operators.python_operator</span> <span class="kn">import</span> <span class="n">PythonOperator</span>
<span class="kn">from</span> <span class="nn">airflow.operators.dummy_operator</span> <span class="kn">import</span> <span class="n">DummyOperator</span>


<span class="k">def</span> <span class="nf">login_func</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Attempt to login with account = </span><span class="si">{</span><span class="n">account</span><span class="si">}</span><span class="s">, password = </span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>


<span class="n">account</span> <span class="o">=</span> <span class="s">"user"</span>
<span class="n">password</span> <span class="o">=</span> <span class="s">"password"</span>
<span class="n">default_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"owner"</span><span class="p">:</span> <span class="s">"THE_ONE"</span><span class="p">,</span>
    <span class="s">"start_date"</span><span class="p">:</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="s">"schedule_interval"</span><span class="p">:</span> <span class="s">"@daily"</span><span class="p">,</span>
    <span class="s">"retries"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s">"retry_delay"</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">with</span> <span class="n">DAG</span><span class="p">(</span><span class="s">"login_dag"</span><span class="p">,</span> <span class="n">default_args</span><span class="o">=</span><span class="n">default_args</span><span class="p">)</span> <span class="k">as</span> <span class="n">dag</span><span class="p">:</span>
    <span class="n">login</span> <span class="o">=</span> <span class="n">PythonOperator</span><span class="p">(</span>
        <span class="n">task_id</span><span class="o">=</span><span class="s">"login"</span><span class="p">,</span>
        <span class="n">python_callable</span><span class="o">=</span><span class="n">login_func</span><span class="p">,</span>
        <span class="n">op_args</span><span class="o">=</span><span class="p">[</span><span class="n">account</span><span class="p">,</span> <span class="n">password</span><span class="p">],</span>
        <span class="n">provide_context</span><span class="o">=</span><span class="bp">True</span>
    <span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">DummyOperator</span><span class="p">(</span><span class="n">task_id</span><span class="o">=</span><span class="s">"do_nothing"</span><span class="p">)</span>

    <span class="n">login</span> <span class="o">&gt;&gt;</span> <span class="n">end</span>
</code></pre></div></div>

<p>åœ¨ä¸Šé¢çš„ç¨‹å¼ç¢¼è£¡é¢ï¼Œæˆ‘å€‘å…ˆå®šç¾©äº†ä¸€å€‹functionï¼Œå‡è£æ˜¯è¦ç™»å…¥æŸå€‹æœå‹™ï¼Œæ¥è‘—å®šç¾©äº†functionéœ€è¦ä½¿ç”¨åˆ°çš„åƒæ•¸<code class="language-plaintext highlighter-rouge">account</code>å’Œ<code class="language-plaintext highlighter-rouge">password</code>ï¼Œå†ä¾†æ˜¯é€™å€‹ä»»å‹™çš„åƒæ•¸ï¼Œæœ€å¾Œæ˜¯æ•´å€‹ä»»å‹™çš„æµç¨‹ã€‚</p>

<p><a href="https://airflow.apache.org/docs/apache-airflow/stable/concepts/operators.html">airflowæä¾›äº†è¨±è¨±å¤šå¤šçš„operator</a>ï¼Œå¯ä»¥æ ¹æ“šè‡ªå·±çš„éœ€è¦ä¾†å»é¸æ“‡å“ªä¸€å€‹operatoræ¯”è¼ƒé©åˆé€™å€‹ä»»å‹™ï¼Œåœ¨å®šç¾©å¥½äº†operatorçš„objectä»¥å¾Œï¼Œå†é€é<code class="language-plaintext highlighter-rouge">login &gt;&gt; end</code>é€™æ¨£çš„æ–¹å¼ä¾†å»æŠŠé€™äº›operatorä¸²åœ¨ä¸€èµ·ï¼Œé€™é‚Šä¹Ÿæ”¯æ´åˆ†æ”¯ï¼Œåªè¦æ•´å€‹æµç¨‹æ˜¯ä¸€å€‹Directed Acyclic Graphï¼ˆDAGï¼‰å°±è¡Œã€‚</p>

<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæˆ‘åœ¨å¯«çš„æ™‚å€™å¦‚æœæŠŠ<code class="language-plaintext highlighter-rouge">with DAG(...):</code>é€™ä¸€æ®µæ”¾é€²<code class="language-plaintext highlighter-rouge">if __name__ == "__main__"</code>çš„è©±ï¼Œå¥½åƒairflowå°±æŠ“ä¸åˆ°çš„æ¨£å­ï¼Œåœ¨å¯«çš„æ™‚å€™éœ€è¦æ³¨æ„ä¸€ä¸‹ã€‚</p>

<h3 id="æ¸¬è©¦æ–°åŠ å…¥çš„ä»»å‹™">æ¸¬è©¦æ–°åŠ å…¥çš„ä»»å‹™</h3>

<p>åœ¨å¯«å¥½ä¸Šé¢çš„scriptä»¥å¾Œï¼Œå¯ä»¥ç›´æ¥åƒä»¥å¾€å¯«pythonçš„æ–¹å¼é‚£æ¨£å»åŸ·è¡Œçœ‹çœ‹ï¼Œå®ƒä¸¦ä¸æœƒçœŸçš„å»åŸ·è¡Œï¼Œairflowæœƒå»çœ‹æœ‰æ²’æœ‰å“ªé‚Šæœ‰èªæ³•ä¸Šçš„éŒ¯èª¤ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 /path/to/your/script.py
</code></pre></div></div>

<p>å¦‚æœæƒ³è¦å¯¦éš›æ¸¬è©¦çœ‹çœ‹ï¼Œå¯ä»¥ä¸Šå»UIã€é»é€²jobè£¡é¢ï¼Œå³ä¸Šè§’æœ‰å€‹ä¸‰è§’å½¢å¯ä»¥æ‰‹å‹•è·‘æ•´å€‹æµç¨‹è©¦è©¦çœ‹ã€‚</p>

<p><img src="./airflow_job.png" alt="Airflow Job Page" /></p>

<p>å¦‚æœè·‘èµ·ä¾†æœ‰ç¬¦åˆé æœŸçš„è©±ï¼Œå°±èƒ½toggleå·¦ä¸Šè§’çš„é¸é …ï¼Œå•Ÿå‹•é€™å€‹DAGï¼Œè®“å®ƒæ ¹æ“šè¨­å®šçš„é »ç‡ä¾†åŸ·è¡Œäº†ã€‚</p>

<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œç•¶é–‹å•Ÿé€™å€‹DAGä»¥å¾Œï¼Œairflowæœƒè£œè·‘<code class="language-plaintext highlighter-rouge">start_date</code>åˆ°ä»Šå¤©çš„æ‰€æœ‰jobï¼Œæ‰€ä»¥è¦å…ˆç¢ºå®šä¸€ä¸‹<code class="language-plaintext highlighter-rouge">start_date</code>æœ‰æ²’æœ‰è¨­å®šå°å†é–‹å•Ÿæœƒæ¯”è¼ƒå¥½ã€‚</p>

<h3 id="é–‹å§‹çš„æ™‚é–“è·Ÿé æœŸçš„ä¸åŒ">é–‹å§‹çš„æ™‚é–“è·Ÿé æœŸçš„ä¸åŒï¼Ÿ</h3>

<p>åœ¨ä¸Šé¢çš„scriptè£¡é¢ï¼Œæˆ‘å€‘è¨­å®š</p>

<pre><code class="language-python3">    "start_date": datetime(2022, 2, 8, 11, 0),
    "schedule_interval": "@daily",
</code></pre>

<p>æœŸæœ›å®ƒå¯ä»¥å¾2022/2/8çš„æ—©ä¸Š11é»é–‹å§‹åŸ·è¡Œç¬¬ä¸€æ¬¡ï¼Œä¸¦ä»¥å¤©ç‚ºé »ç‡ä¾†åŸ·è¡Œï¼Œä½†å¯¦éš›ä¸Šæœƒç™¼ç¾å®ƒç¬¬ä¸€æ¬¡çš„åŸ·è¡Œæ™‚é–“æœƒæ˜¯2022/2/9çš„æ—©ä¸Š11é»ï¼ŒåŸå› æ˜¯å› ç‚ºä¸Šé¢å¯«çš„æ˜¯ä»»å‹™æ™‚é–“ï¼Œè·Ÿå¯¦éš›ä¸ŠåŸ·è¡Œçš„æ™‚é–“ä¸åŒï¼Œairflowæœƒåœ¨<code class="language-plaintext highlighter-rouge">start_date+schedule_interval</code>çš„æ™‚é–“éå®Œä»¥å¾Œæ‰é–‹å§‹è™•ç†<code class="language-plaintext highlighter-rouge">start_date+schedule_interval</code>çš„è³‡æ–™ã€‚</p>

<p>æƒ³æ³•ä¸Šæœ‰é»é¡ä¼¼æ–¼ï¼Œæˆ‘æƒ³å°‡ä»Šå¤©ä½¿ç”¨è€…çš„è³‡æ–™çµ±æ•´èµ·ä¾†ï¼Œä¸¦å£“ä¸Šä»Šå¤©çš„æ—¥æœŸï¼Œä½†æˆ‘å¯¦éš›åŸ·è¡Œçµ±æ•´é€™å€‹å‹•ä½œçš„æ™‚é–“æœƒæ˜¯åœ¨æ˜å¤©ï¼Œå› ç‚ºä»Šå¤©é‚„æ²’æœ‰éå®Œï¼Œå¦‚æœä»Šå¤©å°±åšçµ±æ•´ï¼Œå°±æœƒæœ‰éƒ¨åˆ†çš„è³‡æ–™è¢«æ¼æ‰ã€‚</p>

<h2 id="çµè«–">çµè«–</h2>

<p>Airflowæ˜¯å€‹å®‰è£ç°¡å–®ã€åŠŸèƒ½ä¹Ÿå¾ˆé½Šå…¨çš„æ’ç¨‹ç³»çµ±ï¼Œä¸Šé¢æ•˜è¿°çš„éƒ¨åˆ†åªæ˜¯airflowçš„ä¹ç‰›ä¸€æ¯›è€Œå·²ï¼Œé‚„æœ‰è¨±è¨±å¤šå¤šçš„åŠŸèƒ½æ²’æœ‰è¢«è¦†è“‹åˆ°ï¼Œå¦‚æœæœ‰èˆˆè¶£æˆ–æ˜¯æœ‰è¤‡é›œçš„åŠŸèƒ½æƒ³è¦å¯¦ç¾ï¼Œå¯ä»¥å»çœ‹çœ‹<a href="https://airflow.apache.org/docs/apache-airflow/stable/index.html">airflowçš„å®˜æ–¹æ–‡ä»¶</a>ã€‚</p>

<h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™</h2>

<ol>
  <li><a href="https://leemeng.tw/a-story-about-airflow-and-data-engineering-using-how-to-use-python-to-catch-up-with-latest-comics-as-an-example.html">ä¸€æ®µ Airflow èˆ‡è³‡æ–™å·¥ç¨‹çš„æ•…äº‹ï¼šè«‡å¦‚ä½•ç”¨ Python è¿½æ¼«ç•«é€£è¼‰</a></li>
</ol>]]></content><author><name>Your Name</name></author><category term="Tool" /><summary type="html"><![CDATA[é€™ç¯‡æ–‡ç« ç´€éŒ„ä¸€ä¸‹å˜—è©¦ä½¿ç”¨Airflowçš„ç¶“æ­·ã€‚]]></summary></entry><entry><title type="html">AutoKerasä»‹ç´¹</title><link href="https://wjohn1483.github.io/#%20the%20base%20hostname%20&%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2021/12/23/autokeras-introduction/" rel="alternate" type="text/html" title="AutoKerasä»‹ç´¹" /><published>2021-12-23T00:00:00+00:00</published><updated>2021-12-23T00:00:00+00:00</updated><id>https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2021/12/23/autokeras-introduction</id><content type="html" xml:base="https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2021/12/23/autokeras-introduction/"><![CDATA[<p>ç¾åœ¨å¸‚é¢ä¸Šæœ‰çœ¾å¤šAutoMLçš„æ¡†æ¶ï¼Œè€Œç”¨æ·±åº¦å­¸ç¿’ä¸¦æœ‰Neural Architecture Searchï¼ˆNASï¼‰åŠŸèƒ½çš„ä¸¦ä¸å¤šï¼Œé€™é‚Šç´€éŒ„ä¸€ä¸‹ä½¿ç”¨AutoKerasçš„å¿ƒå¾—ã€‚</p>

<!--more-->

<h2 id="å®‰è£autokeras">å®‰è£AutoKeras</h2>

<p>å®‰è£çš„æ–¹å¼å¾ˆç°¡å–®ï¼Œåªéœ€è¦<code class="language-plaintext highlighter-rouge">pip install</code>å°±è¡Œäº†ï¼Œä¸éå€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨æ–‡ç« æ’°å¯«çš„ç•¶ä¸‹ï¼Œé›–ç„¶<a href="https://autokeras.com/install/">AutoKerasçš„å®˜ç¶²</a>ä¸Šå¯«æ”¯æ´tensorflow 2.3.0ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œä½†å¯¦éš›ç”¨tensorflow 2.7.0çš„æ™‚å€™æœƒå‡ºç¾å•é¡Œï¼Œå»ºè­°é‚„æ˜¯å…ˆä½¿ç”¨tensorflow 2.3.0ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip3 <span class="nb">install </span><span class="nv">tensorflow</span><span class="o">==</span>2.3.0 autokeras
</code></pre></div></div>

<h2 id="åˆ©ç”¨autokerasåštext-classification">åˆ©ç”¨AutoKerasåštext classification</h2>

<p>åœ¨<a href="https://autokeras.com/tutorial/overview/">AutoKerasçš„å®˜ç¶²</a>ä¸Šæœ‰å¾ˆå¤štutorialä¾†åšä¸åŒçš„ä»»å‹™ï¼Œåƒæ˜¯text classificationã€image classificationç­‰ç­‰ï¼Œé€™é‚Šå˜—è©¦çš„æ˜¯tutorialè£¡é¢çš„text classificationï¼Œä»»å‹™æ˜¯sentiment analysisï¼Œçµ¦å®šä¸€å€‹è©•è«–ï¼Œåˆ¤æ–·é€™å€‹è©•è«–æ˜¯æ­£é¢é‚„æ˜¯è² é¢çš„ã€‚</p>

<h3 id="æº–å‚™è¨“ç·´ç”¨çš„è³‡æ–™">æº–å‚™è¨“ç·´ç”¨çš„è³‡æ–™</h3>

<p>åº•ä¸‹çš„ç¨‹å¼ç¢¼æœƒå»å¾ç¶²è·¯ä¸ŠæŠ“å–datasetä¸‹ä¾†ï¼Œä¸¦åšæˆnumpyï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ–‡å­—çš„éƒ¨åˆ†æˆ‘å€‘ä¸¦æ²’æœ‰è½‰æˆindexï¼Œè€Œæ˜¯å–®ç´”çš„stringï¼Œè½‰æˆindexçš„éƒ¨åˆ†æœƒäº¤ç”±autokerasæ”¾åœ¨æ¨¡å‹è£¡é¢ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_files</span>


<span class="k">print</span><span class="p">(</span><span class="s">"Preparing data..."</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">get_file</span><span class="p">(</span>
    <span class="n">fname</span><span class="o">=</span><span class="s">"aclImdb.tar.gz"</span><span class="p">,</span>
    <span class="n">origin</span><span class="o">=</span><span class="s">"http://ai.stanford.edu/~amaas/data/sentiment/aclImdb_v1.tar.gz"</span><span class="p">,</span>
    <span class="n">extract</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># set path to dataset
</span><span class="n">IMDB_DATADIR</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="s">"aclImdb"</span><span class="p">)</span>

<span class="n">classes</span> <span class="o">=</span> <span class="p">[</span><span class="s">"pos"</span><span class="p">,</span> <span class="s">"neg"</span><span class="p">]</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">load_files</span><span class="p">(</span>
    <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">IMDB_DATADIR</span><span class="p">,</span> <span class="s">"train"</span><span class="p">),</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">classes</span>
<span class="p">)</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">load_files</span><span class="p">(</span>
    <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">IMDB_DATADIR</span><span class="p">,</span> <span class="s">"test"</span><span class="p">),</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">classes</span>
<span class="p">)</span>

<span class="n">x_train</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_data</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_data</span><span class="p">.</span><span class="n">target</span><span class="p">)</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_data</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_data</span><span class="p">.</span><span class="n">target</span><span class="p">)</span>

<span class="c1"># Minimize training size for tutorial
</span><span class="n">sample_size</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="p">[:</span><span class="n">sample_size</span><span class="p">]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">[:</span><span class="n">sample_size</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Data samples..."</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">x_train</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (sample_size,)
</span><span class="k">print</span><span class="p">(</span><span class="n">y_train</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (sample_size,)
</span><span class="k">print</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">50</span><span class="p">])</span>  <span class="c1"># b'Zero Day leads you to think, even re-think why two'
</span><span class="k">print</span><span class="p">(</span><span class="n">y_train</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">30</span><span class="p">])</span>  <span class="c1"># [1 0 1 0 0 1 1 0 0 1 0 0 0 1 0 1 1 1 1 1 1 1 0 0 1 0 0 0 1 0]
</span></code></pre></div></div>

<h3 id="è¨“ç·´æ¨¡å‹">è¨“ç·´æ¨¡å‹</h3>

<p>åœ¨é€™é‚Šæˆ‘å€‘ä½¿ç”¨autokerasè£¡é¢çš„TextClassifierï¼Œè¨­å®š<code class="language-plaintext highlighter-rouge">max_trials</code>ç‚º2ï¼Œä»£è¡¨å˜—è©¦2ç¨®ä¸åŒçš„æ¨¡å‹æ¶æ§‹ï¼Œå¯ä»¥è¦–æƒ…æ³æŠŠé€™å€‹æ•¸å­—èª¿å¤§ï¼Œè€Œ<code class="language-plaintext highlighter-rouge">overwrite</code>æœƒå°‡ä¸Šæ¬¡è¨“ç·´çš„çµæœè¦†è“‹æ‰ï¼Œå¦‚æœæƒ³æ¥çºŒä¸Šæ¬¡è¨“ç·´ï¼Œå¯ä»¥æ”¹æˆ<code class="language-plaintext highlighter-rouge">False</code>ã€‚</p>

<p>åœ¨<code class="language-plaintext highlighter-rouge">fit()</code>è£¡é¢æœ‰è¨­å®š<code class="language-plaintext highlighter-rouge">epochs</code>ï¼Œè¡¨ç¤ºæ¯ä¸€å€‹æ¨¡å‹æ¶æ§‹æœƒè¨“ç·´å¤šå°‘å€‹epochã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">autokeras</span> <span class="k">as</span> <span class="n">ak</span>


<span class="k">print</span><span class="p">(</span><span class="s">"Building model..."</span><span class="p">)</span>
<span class="c1"># Initialize the text classifier.
</span><span class="n">clf</span> <span class="o">=</span> <span class="n">ak</span><span class="p">.</span><span class="n">TextClassifier</span><span class="p">(</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">max_trials</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>  <span class="c1"># It only tries 2 models as a quick demo.
</span><span class="n">clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œ<code class="language-plaintext highlighter-rouge">TextClassifier</code>å¯ä»¥è¨­å®šæ¨¡å‹çš„metricsè¦æ˜¯ä»€éº¼ï¼Œé è¨­æ˜¯<code class="language-plaintext highlighter-rouge">val_loss</code>ï¼Œå¯ä»¥ä¾æ“šä»»å‹™çš„éœ€æ±‚ä¾†åšä¿®æ”¹ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cls</span> <span class="o">=</span> <span class="n">ak</span><span class="p">.</span><span class="n">TextClassifier</span><span class="p">(</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">max_trials</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">objective</span><span class="o">=</span><span class="s">"accuracy"</span><span class="p">,</span>  <span class="c1"># Change to other metric that is suitable for your task
</span><span class="p">)</span>
</code></pre></div></div>

<p>å¦å¤–ï¼Œ<code class="language-plaintext highlighter-rouge">TextClassifier</code>æœƒè‡ªå·±å»åˆ¤æ–·labelæœ‰å¤šå°‘å€‹ï¼Œä¸¦è‡ªå·±å°labelåšindexï¼Œåªæ˜¯åœ¨é æ¸¬çš„æ™‚å€™ä¸¦ä¸æœƒè‡ªå‹•æŠŠindexè½‰å›åŸæœ¬labelçš„æ¨£å­ï¼Œå»ºè­°é€™é‚Šè‡ªå·±å…ˆç”¨<code class="language-plaintext highlighter-rouge">sklearn.preprocessing.LabelEncoder</code>å…ˆå°labelåšindexï¼Œä¸¦åœ¨<code class="language-plaintext highlighter-rouge">fit()</code>çš„æ™‚å€™é¤µå…¥è½‰å¥½indexçš„è³‡æ–™ï¼Œä¹‹å¾Œåœ¨é æ¸¬æ™‚ï¼Œå°±å¯ä»¥ä½¿ç”¨<code class="language-plaintext highlighter-rouge">LabelEncoder</code>ä¾†è½‰å›labelåŸæœ¬çš„æ¨£å­ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pickle</span>


<span class="c1"># Before training
</span><span class="n">labeler</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">().</span><span class="n">fit</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">labeler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
<span class="n">pickle</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">labeler</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s">"/path/to/labeler.pkl"</span><span class="p">,</span> <span class="s">"wb"</span><span class="p">),</span> <span class="n">pickle</span><span class="p">.</span><span class="n">HIGHEST_PROTOCOL</span><span class="p">)</span>

<span class="c1"># After training
</span><span class="n">labeler</span> <span class="o">=</span> <span class="n">pickle</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">"/path/to/labeler.pkl"</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">))</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">labeler</span><span class="p">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div></div>

<h3 id="å„²å­˜æ¨¡å‹">å„²å­˜æ¨¡å‹</h3>

<p>é€™é‚Šæœƒå„²å­˜è¡¨ç¾æœ€å¥½çš„æ¨¡å‹ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">clf</span><span class="p">.</span><span class="n">export_model</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">model</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"./model"</span><span class="p">,</span> <span class="n">save_format</span><span class="o">=</span><span class="s">"tf"</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">Exception</span><span class="p">:</span>
    <span class="n">model</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"./model.h5"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="æ¨¡å‹é æ¸¬">æ¨¡å‹é æ¸¬</h3>

<p>autokerasè¼¸å‡ºçš„æ¨¡å‹è·Ÿä¸€èˆ¬kerasè¨“ç·´å‡ºä¾†çš„æ¨¡å‹ç›¸åŒï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥ç”¨kerasçš„<code class="language-plaintext highlighter-rouge">load_model()</code>ä¾†è®€å–æ¨¡å‹ï¼Œä¸éæœƒéœ€è¦åœ¨å¾Œé¢åŠ ä¸Š<code class="language-plaintext highlighter-rouge">custom_objects</code>ï¼ŒæŠŠautokerasè‡ªå®šç¾©çš„objectå¸¶é€²ä¾†ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>


<span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s">"./model"</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="n">ak</span><span class="p">.</span><span class="n">CUSTOM_OBJECTS</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="n">summary</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="çµè«–">çµè«–</h2>

<p>å¯ä»¥ç¨å¾®ç€è¦½ä¸€ä¸‹<a href="https://autokeras.com/tutorial/overview/">autokerasçš„tutorial</a>ï¼Œå¦‚æœç¢°åˆ°çš„ä»»å‹™ç¨®é¡æœ‰åœ¨è£¡é¢ï¼Œå¯ä»¥å˜—è©¦çœ‹çœ‹ï¼Œåªä¸éæœƒéœ€è¦è·‘åœ¨å¯ä»¥é€£ä¸Šå¤–ç¶²çš„æ©Ÿå™¨ä¸Šï¼Œå› ç‚ºautokerasæœƒå»ç¶²è·¯ä¸ŠæŠ“ä¸€äº›pretrainçš„æ¨¡å‹ä¸‹ä¾†ï¼Œå¦å¤–ä¹Ÿéœ€è¦æ³¨æ„ä¸€ä¸‹ç¡¬ç¢Ÿçš„ä½¿ç”¨é‡ï¼Œå› ç‚ºautokerasæœƒæŠŠæ¯å€‹trialè¨“ç·´çš„æ¨¡å‹å„²å­˜ä¸‹ä¾†ï¼Œå¾ˆå®¹æ˜“æŠŠç¡¬ç¢Ÿåƒæ»¿ï¼Œä¸ç„¶å°±æ˜¯éœ€è¦åœ¨<a href="https://autokeras.com/text_classifier/">ak.TextClassifier</a>è£¡é¢é™åˆ¶<code class="language-plaintext highlighter-rouge">max_model_size</code>çš„å¤§å°ã€‚</p>]]></content><author><name>Your Name</name></author><category term="Tool" /><summary type="html"><![CDATA[ç¾åœ¨å¸‚é¢ä¸Šæœ‰çœ¾å¤šAutoMLçš„æ¡†æ¶ï¼Œè€Œç”¨æ·±åº¦å­¸ç¿’ä¸¦æœ‰Neural Architecture Searchï¼ˆNASï¼‰åŠŸèƒ½çš„ä¸¦ä¸å¤šï¼Œé€™é‚Šç´€éŒ„ä¸€ä¸‹ä½¿ç”¨AutoKerasçš„å¿ƒå¾—ã€‚]]></summary></entry><entry><title type="html">Unsupervised Speech Recognition</title><link href="https://wjohn1483.github.io/#%20the%20base%20hostname%20&%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2021/08/28/unsupervised-speech-recognition/" rel="alternate" type="text/html" title="Unsupervised Speech Recognition" /><published>2021-08-28T00:00:00+00:00</published><updated>2021-08-28T00:00:00+00:00</updated><id>https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2021/08/28/unsupervised-speech-recognition</id><content type="html" xml:base="https://wjohn1483.github.io/#%20the%20base%20hostname%20&amp;%20protocol%20for%20your%20site%20e.g.%20https://www.someone.com/2021/08/28/unsupervised-speech-recognition/"><![CDATA[<p>ç°¡å–®ä»‹ç´¹ä¸€ä¸‹Facebook AI Researchå‰é™£å­å‡ºçš„ã€ä»¥éç›£ç£çš„æ–¹å¼ä¾†åšèªéŸ³è¾¨è­˜çš„<a href="https://ai.facebook.com/research/publications/unsupervised-speech-recognition">paper</a>ã€‚</p>

<!--more-->

<h2 id="model-framework">Model Framework</h2>

<p>åœ¨é€™ç¯‡<a href="https://ai.facebook.com/blog/wav2vec-unsupervised-speech-recognition-without-supervision/">å®˜æ–¹çš„éƒ¨è½æ ¼æ–‡ç« </a>è£¡é¢æœ‰å°æ•´ç¯‡paperæœ‰å€‹å¤§è‡´çš„ä»‹ç´¹ï¼Œä¹Ÿæœ‰ä¸€æ®µå½±ç‰‡è¬›è§£é€™ç¯‡paperä½¿ç”¨çš„æ–¹æ³•ã€‚</p>

<p><img src="./wav2vec_u_framework.png" alt="wav2vec U Framework" /></p>

<p>ä¸Šåœ–æ˜¯é€™ç¯‡paper wav2vec Uçš„æ•´é«”æ¶æ§‹ï¼Œé¦–å…ˆæœƒå…ˆæŠŠæ•´æ®µèªéŸ³é€éwav2vec 2.0è½‰æ›æˆfeature sequenceï¼Œå†ä¾†å°é€™äº›featureåšk-meansï¼Œè—‰ç”±k-meansæ‰€ç²å¾—çš„clusterä¾†å°èªéŸ³è¨Šè™Ÿåšsegmentationï¼Œæœ€å¾Œå°‡segmentå¥½çš„èªéŸ³è¨Šè™Ÿçš„featureè¼¸å…¥è‡³generatorä¸­è½‰æ›æˆphoneme sequenceï¼Œæ­é…GANçš„æ–¹å¼ä¾†å»åšè¨“ç·´ã€‚</p>

<h2 id="wav2vec-20">wav2vec 2.0</h2>

<p><img src="./wav2vec_2_framework.png" alt="wav2vec 2.0 Framework" /></p>

<p>wav2vec 2.0çš„è¨“ç·´æ–¹å¼è·ŸBERTæœ‰äº›é¡ä¼¼ï¼Œé¦–å…ˆæœƒå…ˆå°‡èªéŸ³è¨Šè™Ÿé€éCNNæŠ½å–å‡ºé€™æ®µèªéŸ³çš„ç‰¹å¾µï¼Œæ¥è‘—å°å®ƒåšproduct quantizationï¼Œåœ¨æŠŠquantizationå‰çš„featureè¼¸å…¥é€²transformerä»¥å¾Œï¼Œå¸Œæœ›åœ¨è¢«maskæ‰çš„ä½ç½®æ‰€ç”¢ç”Ÿå‡ºä¾†çš„featureè¦è¶Šåƒquantizationå¾Œçš„featureè¶Šå¥½ï¼Œåœ¨è¨“ç·´çš„æ™‚å€™ä¹Ÿæœƒæ‹¿å…¶ä»–æ™‚é–“é»ç¶“équantizationå¾Œçš„featureä¾†åšcontrasive trainingã€‚</p>

<h3 id="product-quantization">Product Quantization</h3>

<p><img src="https://i.typlog.com/fabwrite/NM/ZL0fPpntjxi3pzrQirdw.png?x-oss-process=style/l" alt="Product Quantization" /></p>

<p><em><a href="http://www.fabwrite.com/productquantization">å®ä¾‹ç†è§£product quantizationç®—æ³•</a></em></p>

<p>å‡å¦‚èªªæˆ‘å€‘ç¾åœ¨æœ‰5è¬å¼µåœ–ç‰‡çš„featureï¼Œæ¯å€‹featureæœ‰1024ç¶­ï¼Œæˆ‘å€‘å°‡é€™1024ç¶­åˆ‡æˆ8ä»½ï¼Œæ¯ä»½æœ‰128ç¶­å¦‚ä¸Šåœ–é‚£æ¨£ï¼Œæ¥è‘—ä»¥ç¶­åº¦ç‚ºå–®ä½ä¾†åšk-meansï¼Œé€™é‚Šä»¤k=256ï¼Œæˆ‘å€‘å°±å¯ä»¥å°‡åŸå…ˆ1024ç¶­çš„featureè½‰æ›æˆç”±8å€‹cluster idæ‰€çµ„æˆçš„å‘é‡ï¼ŒæŠŠ1024ç¶­é™æˆäº†8ç¶­ã€‚</p>

<h2 id="segment-representations">Segment Representations</h2>

<p>ä¸€æ®µèªéŸ³è¼¸å…¥é€²wav2vec 2.0ä»¥å¾Œï¼Œæˆ‘å€‘å¯ä»¥å¾—åˆ°ä¸€ä¸²vector sequenceï¼Œè€Œä½œè€…å€‘æŠŠæ‰€æœ‰è¨“ç·´è³‡æ–™è£¡é¢çš„èªéŸ³éƒ½ä¸Ÿé€²å»wav2vec 2.0ï¼Œå°‡ç”¢ç”Ÿå‡ºä¾†çš„ä¸€å †å‘é‡æ‹¿å»åšk-meansï¼Œå¯ä»¥èªªæ˜¯å°æ¯ä¸€å°æ®µèªéŸ³è¨Šè™Ÿéƒ½çµ¦å®ƒä¸€å€‹ç·¨è™Ÿã€‚å¦‚æœæˆ‘å€‘ç™¼ç¾åˆ°èªªä¸€æ®µèªéŸ³è£¡é¢ç›¸é„°å…©å€‹featureçš„ç·¨è™Ÿç›¸åŒï¼Œå°±å¯ä»¥å°‡ä»–å€‘è¦–ç‚ºåœ¨åŒä¸€å€‹segmentè£¡é¢ï¼Œç›´åˆ°ç¢°åˆ°ä¸åŒç·¨è™Ÿã€‚</p>

<p>ä½œè€…å€‘å°‡åŒä¸€å€‹segmentè£¡é¢çš„featureåšå¹³å‡ä¾†ç•¶ä½œæ˜¯é€™å€‹segmentçš„representationï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œä½œè€…å€‘ä¸¦ä¸æ˜¯ç›´æ¥ä½¿ç”¨wav2vec 2.0ç”¢ç”Ÿå‡ºä¾†çš„featureåšå¹³å‡ï¼Œè€Œæ˜¯å…ˆå°æ‰€æœ‰è¨“ç·´è³‡æ–™ç¶“éwav2vec 2.0ç”¢ç”Ÿå‡ºçš„featureåšPCAï¼Œç”¨ç¶“éPCAè½‰æ›çš„featureå†ä¾†åšå¹³å‡ä»¥å¾Œç•¶ä½œsegmentçš„representationã€‚</p>

<h2 id="gan">GAN</h2>

<p><img src="./gan_framework.png" alt="GAN Framework" /></p>

<p>åœ¨å¾—åˆ°äº†segment representationä»¥å¾Œï¼Œæ¥ä¸‹ä¾†ä½œè€…å€‘å°‡é€™äº›representationè¼¸å…¥é€²generatorè£¡é¢ï¼Œå¸Œæœ›generatorç›´æ¥ç”¢ç”Ÿå‡ºphoneme distributionï¼Œé€™é‚Šå†æ­é…å¯¦éš›ä¸Šæ–‡å­—çš„æ‰€è½‰æ›å‡ºä¾†çš„phoneme 1-hot encodingï¼Œé€édiscriminatorä¾†è®“generatorç”¢ç”Ÿå‡ºçš„phoneme distributionèƒ½è¶ŠåƒçœŸå¯¦çš„phonemeè¶Šå¥½ã€‚å¦å¤–åœ¨é€™é‚Šä½œè€…å€‘æœ‰å°‡generatorç”¢ç”Ÿå‡ºä¾†ã€argmaxä»¥å¾Œæ˜¯ç›¸åŒçš„outputå†åšä¸€æ¬¡å¹³å‡ï¼Œä¹‹å¾Œæ‰è¼¸å…¥é€²discriminatorä¸­ã€‚</p>

<h2 id="experiment-results">Experiment Results</h2>

<p><img src="./librispeech_results.png" alt="Librispeech Results" /></p>

<p>åœ¨ç¶“éç¹è¤‡çš„è¨“ç·´æµç¨‹ä»¥å¾Œï¼Œå¯ä»¥çœ‹åˆ°wav2vec Uçš„è¡¨ç¾ä¸ä¿—ï¼Œæ­é…å²å®³çš„language modelä»¥å¾Œï¼Œerror rateå¯ä»¥åª²ç¾æ•¸å¹´å‰supervised learningçš„çµæœã€‚</p>

<p><img src="./low_resource_languages_results.png" alt="Low Resource Languages Results" /></p>

<p>åœ¨low-resourceä¸Šçš„è¡¨ç¾ç”šè‡³å¯ä»¥è´ésupervised learningçš„çµæœã€‚</p>

<h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™</h2>

<ol>
  <li><a href="http://www.fabwrite.com/productquantization">å®ä¾‹ç†è§£product quantizationç®—æ³•</a></li>
</ol>]]></content><author><name>Your Name</name></author><category term="Paper" /><category term="Speech-Recognition" /><summary type="html"><![CDATA[ç°¡å–®ä»‹ç´¹ä¸€ä¸‹Facebook AI Researchå‰é™£å­å‡ºçš„ã€ä»¥éç›£ç£çš„æ–¹å¼ä¾†åšèªéŸ³è¾¨è­˜çš„paperã€‚]]></summary></entry></feed>